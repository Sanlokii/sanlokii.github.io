<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Patriot CTF : Excellent Database | Sanlokii</title>
<meta name=keywords content="Web,Write-up"><meta name=description content="Web - Easy"><meta name=author content><link rel=canonical href=https://sanlokii.eu/writeups/patriotctf/excellent-database/><meta name=google-site-verification content="2Ltuk_c5CMToMVoYbvLW-VNfjIgGqrWdN-rrmVYORaY"><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://sanlokii.eu/assets/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://sanlokii.eu/assets/images/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://sanlokii.eu/assets/imagesfavicon-32x32.png><link rel=apple-touch-icon href=https://sanlokii.eu/assets/images/apple-touch-icon.png><link rel=mask-icon href=https://sanlokii.eu/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://sanlokii.eu/writeups/patriotctf/excellent-database/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Patriot CTF : Excellent Database"><meta property="og:description" content="Web - Easy"><meta property="og:type" content="article"><meta property="og:url" content="https://sanlokii.eu/writeups/patriotctf/excellent-database/"><meta property="og:image" content="https://sanlokii.eu/assets/images/yggdrasil_circle.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2022-05-01T00:00:00+00:00"><meta property="article:modified_time" content="2022-05-01T00:00:00+00:00"><meta property="og:site_name" content="Sanlokii's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sanlokii.eu/assets/images/yggdrasil_circle.png"><meta name=twitter:title content="Patriot CTF : Excellent Database"><meta name=twitter:description content="Web - Easy"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://sanlokii.eu/writeups/"},{"@type":"ListItem","position":2,"name":"Patriot CTF : Excellent Database","item":"https://sanlokii.eu/writeups/patriotctf/excellent-database/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Patriot CTF : Excellent Database","name":"Patriot CTF : Excellent Database","description":"Web - Easy","keywords":["Web","Write-up"],"articleBody":"Statement: I am creating the next big social networking platform, but I am used to setting up unsecured software.\nIf you can login to the admin user, I will give you the flag.\nI’m testing this new database architecture and it’s so beautiful I’ll let you look at the code.\nMaking the source code available main.py:\nimport os from flask import render_template, redirect, request, session, flash, url_for from openpyxl import load_workbook import subprocess import pandas as pd from app import app, USERNAMES, PASSWORDS def add_user(username, password): DB = load_workbook(filename=\"db.xlsx\") Users = DB[\"Users\"] new_row = Users.max_row + 1 Users[f\"{USERNAMES}{new_row}\"] = username Users[f\"{PASSWORDS}{new_row}\"] = password DB.save(filename=\"db.xlsx\") def read_db() -\u003e pd.DataFrame: subprocess.Popen([\"libreoffice\", \"--headless\", \"--convert-to\", \"csv\", \"db.xlsx\"], stdout=subprocess.DEVNULL, stderr=subprocess.STDOUT).communicate() df = pd.read_csv(\"db.csv\") return df @app.route(\"/\", methods=[\"POST\", \"GET\"]) def base(): if not session.get(\"username\"): return redirect(url_for(\"login\")) else: Users = read_db() username = session.get(\"username\") password = Users.query(f \"Username == '{username}'\")[\"Password\"].values[0] return render_template('index.html', name=username, password=password) @app.route(\"/admin\", methods=[\"GET\"]) def admin(): username = session.get(\"username\") if username != \"admin\": return redirect(\"/\") else: return render_template(\"admin.html\", name=username) @app.route('/login', methods=['GET','POST']) def login(): if request.method == \"GET\": return render_template(\"login.html\") else: username = request.form.get(\"username\") password = request.form.get(\"password\") Users = read_db() if username not in Users.Username.values: flash('Please check your login details and try again.', 'danger') return redirect(url_for('login')) elif password != Users.query(f \"Username == '{username}'\")[\"Password\"].values[0]: flash('Please check your login details and try again.', 'danger') return redirect(url_for('login')) session[\"username\"] = request.form.get(\"username\") return redirect(\"/\") @app.route('/signup', methods=['GET','POST']) def signup(): if request.method=='POST': username = request.form.get(\"username\") password = request.form.get(\"password\") Users = read_db() if username in Users.Username.values: flash('Username already exists') return redirect(url_for('signup')) else: add_user(username, password) session[\"username\"] = username return redirect(\"/\") else: return render_template('signup.html') @app.route('/logout', methods=['GET']) def logout(): if request.method=='GET': username = session.get(\"username\") session.pop('username', default=None) return redirect(\"/\") if __name__ == \"__main__\": for f in os.listdir(\"flask_session\"): os.remove(os.path.join(\"flask_session\", f)) app.run(debug=False, host='0.0.0.0', threaded=True) Reading the source code, we can see that the database used is the file db.xlsx.\nWe will have to bypass the authentication via a CSVi (CSV Injection).\nWhen creating an account, we can see that the web page displays our password when we are authenticated.\nThe goal is to inject our payload on the password field in order to get the password of the admin account.\nI connect with my account and I use the following payload in the password field:\n=CONCATENATE(A1:B1) Once authenticated, the site tells me that my password is UsernamePassword.\nThis looks very much like column headers, so I try to authenticate with the payload:\n=CONCATENATE(A2:B2) I get the password for the admin account, now I just have to authenticate with the credentials admin:SuperStrongPassword to get the flag.\nFlag: PCTF{Exc3l_is_th3_b3st_d4t4b4s3}\n","wordCount":"417","inLanguage":"en","datePublished":"2022-05-01T00:00:00Z","dateModified":"2022-05-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://sanlokii.eu/writeups/patriotctf/excellent-database/"},"publisher":{"@type":"Organization","name":"Sanlokii","logo":{"@type":"ImageObject","url":"https://sanlokii.eu/assets/images/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://sanlokii.eu/ accesskey=h title="Sanlokii (Alt + H)"><img src=https://sanlokii.eu/assets/images/apple-touch-icon.png alt aria-label=logo height=40>Sanlokii</a><div class=logo-switches><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://sanlokii.eu/writeups/ title=Writeups><span>Writeups</span></a></li><li><a href=https://sanlokii.eu/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://sanlokii.eu/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://sanlokii.eu/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://sanlokii.eu/>Home</a>&nbsp;»&nbsp;<a href=https://sanlokii.eu/writeups/>Writeups</a></div><h1 class="post-title entry-hint-parent">Patriot CTF : Excellent Database</h1><div class=post-description>Web - Easy</div><div class=post-meta><span title='2022-05-01 00:00:00 +0000 UTC'>May 1, 2022</span></div></header><div class=post-content><p><strong>Statement:</strong> I am creating the next big social networking platform, but I am used to setting up unsecured software.</p><p>If you can login to the admin user, I will give you the flag.</p><p>I&rsquo;m testing this new database architecture and it&rsquo;s so beautiful I&rsquo;ll let you look at the code.</p><p>Making the source code available <code>main.py</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> flask <span style=color:#f92672>import</span> render_template, redirect, request, session, flash, url_for
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> openpyxl <span style=color:#f92672>import</span> load_workbook
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> subprocess
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> app <span style=color:#f92672>import</span> app, USERNAMES, PASSWORDS
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>add_user</span>(username, password):
</span></span><span style=display:flex><span>    DB <span style=color:#f92672>=</span> load_workbook(filename<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;db.xlsx&#34;</span>)
</span></span><span style=display:flex><span>    Users <span style=color:#f92672>=</span> DB[<span style=color:#e6db74>&#34;Users&#34;</span>]
</span></span><span style=display:flex><span>    new_row <span style=color:#f92672>=</span> Users<span style=color:#f92672>.</span>max_row <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    Users[<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>USERNAMES<span style=color:#e6db74>}{</span>new_row<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>] <span style=color:#f92672>=</span> username
</span></span><span style=display:flex><span>    Users[<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>PASSWORDS<span style=color:#e6db74>}{</span>new_row<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>] <span style=color:#f92672>=</span> password
</span></span><span style=display:flex><span>    DB<span style=color:#f92672>.</span>save(filename<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;db.xlsx&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>read_db</span>() <span style=color:#f92672>-&gt;</span> pd<span style=color:#f92672>.</span>DataFrame:
</span></span><span style=display:flex><span>    subprocess<span style=color:#f92672>.</span>Popen([<span style=color:#e6db74>&#34;libreoffice&#34;</span>, <span style=color:#e6db74>&#34;--headless&#34;</span>, <span style=color:#e6db74>&#34;--convert-to&#34;</span>, <span style=color:#e6db74>&#34;csv&#34;</span>, <span style=color:#e6db74>&#34;db.xlsx&#34;</span>], stdout<span style=color:#f92672>=</span>subprocess<span style=color:#f92672>.</span>DEVNULL, stderr<span style=color:#f92672>=</span>subprocess<span style=color:#f92672>.</span>STDOUT)<span style=color:#f92672>.</span>communicate()
</span></span><span style=display:flex><span>    df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(<span style=color:#e6db74>&#34;db.csv&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> df
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#34;/&#34;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#34;POST&#34;</span>, <span style=color:#e6db74>&#34;GET&#34;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>base</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> session<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;username&#34;</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> redirect(url_for(<span style=color:#e6db74>&#34;login&#34;</span>))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        Users <span style=color:#f92672>=</span> read_db()
</span></span><span style=display:flex><span>        username <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;username&#34;</span>)
</span></span><span style=display:flex><span>        password <span style=color:#f92672>=</span> Users<span style=color:#f92672>.</span>query(f <span style=color:#e6db74>&#34;Username == &#39;</span><span style=color:#e6db74>{username}</span><span style=color:#e6db74>&#39;&#34;</span>)[<span style=color:#e6db74>&#34;Password&#34;</span>]<span style=color:#f92672>.</span>values[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#39;index.html&#39;</span>, name<span style=color:#f92672>=</span>username, password<span style=color:#f92672>=</span>password)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#34;/admin&#34;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#34;GET&#34;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>admin</span>():
</span></span><span style=display:flex><span>    username <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;username&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> username <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;admin&#34;</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> redirect(<span style=color:#e6db74>&#34;/&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#34;admin.html&#34;</span>, name<span style=color:#f92672>=</span>username)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/login&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;GET&#39;</span>,<span style=color:#e6db74>&#39;POST&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>login</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> request<span style=color:#f92672>.</span>method <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;GET&#34;</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#34;login.html&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        username <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>form<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;username&#34;</span>)
</span></span><span style=display:flex><span>        password <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>form<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;password&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Users <span style=color:#f92672>=</span> read_db()
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> username <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> Users<span style=color:#f92672>.</span>Username<span style=color:#f92672>.</span>values:     
</span></span><span style=display:flex><span>            flash(<span style=color:#e6db74>&#39;Please check your login details and try again.&#39;</span>, <span style=color:#e6db74>&#39;danger&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> redirect(url_for(<span style=color:#e6db74>&#39;login&#39;</span>))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> password <span style=color:#f92672>!=</span> Users<span style=color:#f92672>.</span>query(f <span style=color:#e6db74>&#34;Username == &#39;</span><span style=color:#e6db74>{username}</span><span style=color:#e6db74>&#39;&#34;</span>)[<span style=color:#e6db74>&#34;Password&#34;</span>]<span style=color:#f92672>.</span>values[<span style=color:#ae81ff>0</span>]:
</span></span><span style=display:flex><span>            flash(<span style=color:#e6db74>&#39;Please check your login details and try again.&#39;</span>, <span style=color:#e6db74>&#39;danger&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> redirect(url_for(<span style=color:#e6db74>&#39;login&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        session[<span style=color:#e6db74>&#34;username&#34;</span>] <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>form<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;username&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> redirect(<span style=color:#e6db74>&#34;/&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/signup&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;GET&#39;</span>,<span style=color:#e6db74>&#39;POST&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>signup</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> request<span style=color:#f92672>.</span>method<span style=color:#f92672>==</span><span style=color:#e6db74>&#39;POST&#39;</span>:
</span></span><span style=display:flex><span>        username <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>form<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;username&#34;</span>)
</span></span><span style=display:flex><span>        password <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>form<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;password&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Users <span style=color:#f92672>=</span> read_db()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> username <span style=color:#f92672>in</span> Users<span style=color:#f92672>.</span>Username<span style=color:#f92672>.</span>values:     
</span></span><span style=display:flex><span>            flash(<span style=color:#e6db74>&#39;Username already exists&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> redirect(url_for(<span style=color:#e6db74>&#39;signup&#39;</span>))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            add_user(username, password)
</span></span><span style=display:flex><span>            session[<span style=color:#e6db74>&#34;username&#34;</span>] <span style=color:#f92672>=</span> username
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> redirect(<span style=color:#e6db74>&#34;/&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> render_template(<span style=color:#e6db74>&#39;signup.html&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@app.route</span>(<span style=color:#e6db74>&#39;/logout&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;GET&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>logout</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> request<span style=color:#f92672>.</span>method<span style=color:#f92672>==</span><span style=color:#e6db74>&#39;GET&#39;</span>:
</span></span><span style=display:flex><span>        username <span style=color:#f92672>=</span> session<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;username&#34;</span>)
</span></span><span style=display:flex><span>        session<span style=color:#f92672>.</span>pop(<span style=color:#e6db74>&#39;username&#39;</span>, default<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> redirect(<span style=color:#e6db74>&#34;/&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> f <span style=color:#f92672>in</span> os<span style=color:#f92672>.</span>listdir(<span style=color:#e6db74>&#34;flask_session&#34;</span>):
</span></span><span style=display:flex><span>        os<span style=color:#f92672>.</span>remove(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(<span style=color:#e6db74>&#34;flask_session&#34;</span>, f))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    app<span style=color:#f92672>.</span>run(debug<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>, host<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;0.0.0.0&#39;</span>, threaded<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span></code></pre></div><hr><p>Reading the source code, we can see that the database used is the file <strong>db.xlsx</strong>.</p><p>We will have to bypass the authentication via a CSVi (CSV Injection).</p><p>When creating an account, we can see that the web page displays our password when we are authenticated.</p><p>The goal is to inject our payload on the password field in order to get the password of the admin account.</p><p>I connect with my account and I use the following payload in the password field:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>=CONCATENATE(A1:B1)
</span></span></code></pre></div><p>Once authenticated, the site tells me that my password is <code>UsernamePassword</code>.</p><p>This looks very much like column headers, so I try to authenticate with the payload:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>=CONCATENATE(A2:B2)
</span></span></code></pre></div><p>I get the password for the admin account, now I just have to authenticate with the credentials <code>admin:SuperStrongPassword</code> to get the flag.</p><p>Flag: <code>PCTF{Exc3l_is_th3_b3st_d4t4b4s3}</code></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://sanlokii.eu/tags/web/>Web</a></li><li><a href=https://sanlokii.eu/tags/write-up/>Write-Up</a></li></ul><nav class=paginav><a class=prev href=https://sanlokii.eu/writeups/patriotctf/curly-fry/><span class=title>« Prev</span><br><span>Patriot CTF : Curly Fry</span>
</a><a class=next href=https://sanlokii.eu/writeups/patriotctf/locked/><span class=title>Next »</span><br><span>Patriot CTF : Locked</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Patriot CTF : Excellent Database on x" href="https://x.com/intent/tweet/?text=Patriot%20CTF%20%3a%20Excellent%20Database&amp;url=https%3a%2f%2fsanlokii.eu%2fwriteups%2fpatriotctf%2fexcellent-database%2f&amp;hashtags=Web%2cWrite-up"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Patriot CTF : Excellent Database on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsanlokii.eu%2fwriteups%2fpatriotctf%2fexcellent-database%2f&amp;title=Patriot%20CTF%20%3a%20Excellent%20Database&amp;summary=Patriot%20CTF%20%3a%20Excellent%20Database&amp;source=https%3a%2f%2fsanlokii.eu%2fwriteups%2fpatriotctf%2fexcellent-database%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://sanlokii.eu/>Sanlokii</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>