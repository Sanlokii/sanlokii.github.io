<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Flag4All : Thanks You For The Wildcard CA | Sanlokii</title>
<meta name=keywords content="Forensics,Write-up"><meta name=description content="Forensics - Medium"><meta name=author content><link rel=canonical href=https://sanlokii.eu/writeups/flag4all/thanks_you_for_the_wildcard_ca/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://sanlokii.eu/assets/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://sanlokii.eu/assets/images/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://sanlokii.eu/assets/imagesfavicon-32x32.png><link rel=apple-touch-icon href=https://sanlokii.eu/assets/images/apple-touch-icon.png><link rel=mask-icon href=https://sanlokii.eu/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://sanlokii.eu/writeups/flag4all/thanks_you_for_the_wildcard_ca/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Flag4All : Thanks You For The Wildcard CA"><meta property="og:description" content="Forensics - Medium"><meta property="og:type" content="article"><meta property="og:url" content="https://sanlokii.eu/writeups/flag4all/thanks_you_for_the_wildcard_ca/"><meta property="og:image" content="https://sanlokii.eu/assets/images/yggdrasil_circle.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2023-10-22T00:00:00+00:00"><meta property="article:modified_time" content="2023-10-22T00:00:00+00:00"><meta property="og:site_name" content="Sanlokii's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sanlokii.eu/assets/images/yggdrasil_circle.png"><meta name=twitter:title content="Flag4All : Thanks You For The Wildcard CA"><meta name=twitter:description content="Forensics - Medium"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://sanlokii.eu/writeups/"},{"@type":"ListItem","position":2,"name":"Flag4All : Thanks You For The Wildcard CA","item":"https://sanlokii.eu/writeups/flag4all/thanks_you_for_the_wildcard_ca/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Flag4All : Thanks You For The Wildcard CA","name":"Flag4All : Thanks You For The Wildcard CA","description":"Forensics - Medium","keywords":["Forensics","Write-up"],"articleBody":"Statement:\nESD Secure Message boasts an encrypted online messaging system with an asymmetric encryption mechanism that is reputed to be tamper-proof.\nThe company has hired you to carry out a pentest on a well-defined perimeter over a very short period of time. As a result of this pentest, you were able to recover two items:\nan interception of exchanges from one of the unsecured servers A raw export of one of the encrypted messages from the messaging applicationâ€™s database.\nYour mission: Complete the investigation of the recovered elements and find a way to decrypt the message from the ESD Secure Message application.\nAuthor : shadowmedicis (ESDAcademy - ENI Nantes - HESD03)\nThe challenge provides a network capture in pcap format and an encrypted message.txt.enc file.\nLooking at the contents of the PCAP, I see communication on port 25 (SMTP) : In the network capture, I can see all traffic exchanged :\n220 miniRelay Server v0.9.77d ready EHLO DESKTOP-JB5J4SR 250-net 250-AUTH LOGIN 250 HELP MAIL FROM: 250 tom.rip@esd-secure-message.fr Address Okay RCPT TO: 250 john.legeyo@esd-secure-message.fr Address Okay DATA 354 Start mail input; end with . MIME-Version: 1.0 From: tom.rip@esd-secure-message.fr To: john.legeyo@esd-secure-message.fr Reply-To: tom.rip@esd-secure-message.fr Date: 20 Jun 2021 17:22:20 +0200 Subject: tom.rip@esd-secure-message.fr Content-Type: multipart/mixed; boundary=--boundary_0_bb6793a1-acac-452c-b09f-79c3a99b40c8 ----boundary_0_bb6793a1-acac-452c-b09f-79c3a99b40c8 Content-Type: text/plain; charset=utf-8 Content-Transfer-Encoding: base64 SGkgSm9obiwNCg0KSSBzZW5kIHlvdSB0aGUgbmV3IGNlcnRpZmljYXRlIGZvciByZW5ldyB0 aGUgY2VydGlmaWNhdGUgb2YgaHR0dHBzLy9hY2NvdW50LmVzZC1zZWN1cmUtbWVzc2FnZS5m ci4NCllvdSBrbm93IHRoZSBwYXNzcGhyYXNlLCBpdOKAmXMgdGhlIHNhbWUgcGFzc3dvcmQg b2YgdGhlIGxhdGVzdCBjZXJ0aWZpY2F0ZS4NCkl04oCZcyBsZWdhY3kg8J+YiSAuLg0KDQpU ZWxsIG1lIHdoZW4geW91IGZpbmlzaCB0byBpbnN0YWxsIHRoaXMgY2VydGlmaWNhdGUuDQoN CkJlc3QgcmVnYXJkcywNCg0KVG9tIFJJUA0KRVNEIFNlY3VyZSBNZXNzYWdlDQorMzMoMCk2 IDQ0IDYzIDcxIDEx ----boundary_0_bb6793a1-acac-452c-b09f-79c3a99b40c8 Content-Type: application/octet-stream; name=\"certificate willcard esd-secure-message.fr.zip\" Content-Transfer-Encoding: base64 UEsDBBQAAAAIAAaF1FIkQbPIJQoAADQNAAALAAAAcHJpdmF0ZS5rZXl1l7cS4zoSRXNV6R8m 55sSvXkZvfeeGZ1IiZ6i//rlbr4IkCAA0H379O2//10ML8rGH8el/1iOHNAe/0fl4/+dPB/W POR/vXMs//2D/sMbrBNbHs89Hxyv/pX79/DvH5p3/8IY/pdl2H8gnOVYiIRIlkEpjkYomIcF iAMFDOEEiMSej+cD6xr+sGMipWS4dkj3ys5kvzSOmuphIzisaS5PzCoTH3Rb4nIInL9FaOZW VRe9Inj33SvMwcnJzb1p6hpBf38ukTREU4fNwjJLefEHuUx99TaIzFyPlRllw9YVa4Ld06XW gH8+qMPArWBnI0JZTRIS01gvCk2ywpSjfC4Qj3cruuJZbiFYytc7RLycfrlVtk6cxeS+8Xxc y+rDY8sRk/tVJc/2F0SDYb/dwrk9RDsysDi7PrZ1cSkiOqpm4CuS+FENgmox8GPwfEiJvr5E okSctF7VHj0B4PuSZ3xnqBwtiNV5xXI1eoPNMdReJ95HoV9UsKnyO1qiuWKejz4NpDewwX0x L95xnuKRcJczOhXpOlc7xBpkuFoLEV8s6DxoyXk2z98cTwWOnpgoKzwfTD/to8g6HtKNBiNH asgUjHRGEnZYkd5vEsPmTf/ZFKl4g7yGhnakXWSNt3U+UkayPx9ZBQWloEpreRFX+DvmOGw+ iV9LTRofOvNmW3LeR17gmHjdh6wOPY1Yl2ttanYQ2218PpxPl73WPkuk083kQmKnb1wN/kKU BzANhkny40u3hTIFTJMG89cqs2qNrVymsHS8gd7zUb4uaRZgW9ya3qSH1Sb9W9GbWFQai4Gq stkSLIh9JETOaTYvCmeXCDpCVZlflC7A4PORY1zST2Vv41MgXylMT2CFOdlGUwMV1wwCv11o XKuVzvSGJaiuQqT4yrYLQIyi077sHclX+HFe04+vIXeqgV1attEhsB2oIGPDMLOOW+pkIBis d8zj+m/5Fc2lTa8tQUH8CpvnY7dktYuPzpG5xI0wTpmxY48NHtdJUPupFGSuJlEHpPML7fUt jA26Wzkmvtq3T1dvwH0+jhe8MIgOQod+wd7JFlUjn13uFG8+Dbb0msXZLqKqGfgfaQoJ8qY3 xKJHvMV2hd/Ju7KUOdpw4Nd7FJgyTPdyog5SI7j+DfibK0NE6vfCIUSRJ+CcQoermn9ZaxVB GgEW9fGS54MloN63Ds7MNWln1MPygtMX7grvQQjXmZkY0JYMwyYHOECrJvNTb6QcjppKhv52 v/L5EPW6KGv0rX5prievBVqdKD2WSB42qKLeSYWQPDuPfmIwif5BLyhtVz2rP66ajD+sPe/K 8tlzPD90hXwCtSFxuzI1RReNaW0vE47xLsQJ7CVeveljldRpNs5Zan3iRsC02hf/PB8/mp94 ytxaSD9fYeLpmc7Aa5rK2XbsJw6z1sewne4oETnNp11kaTn+NNSRMWm29oXzfHhyrdypRJFT Hj8fkerGVyOFZ/RmyXLi6wu+rtqTDMW2Sv5klMYAsYWjU7LCVCkBqOL5OIeNmyIy/NXk+cHD WKElepgrGpbCFI6PZDK0M33Dhoh/kc8tqami52rhFNCSkXXQo+eDTwkh+OIhZTJiufD25Ebf Ynl9yGEgSqJunR9IsyGeoijUp5j1oyL7wxJflfgGTQ8n9fMRUj7KCcsHWimsXX1jUBhtEE+b qDxA6EW6cDnOfzPtN62V69Osh9Uo5jYTJbO1eOPEz0dAgcMAJz/Llgjrpo++QRfo+NqNueaT fJllBYupyNsmuFk/FnTtqHPfTA3nzJTbNstNORyW+zAD18h4t/z5Bs1I/YUsvqZ9mIMjwtHu xZb9AmgN2KeKISMXAzv896I3NbSP9vkw8VwPmdJ15MbXfgC7rUAEtYD9Rb0iZd88YMIsOFRT 35k/g7W/L2tZm/X9Iey0xkXppj0Mx79a8DKwbd7sPLM8BImIMNdLsrP2OVjQ2HQh8iqldeAZ w98ZqNckDSKmpSQQAXefD3f3J0/zENRAgP8iWV7Z1/UmruzVNqAhfys3K62J6cQ1HK+gPAg2 mcmtZ9Yd4ao6u/tFiYQzLbaDAn91/wRerOI07ov+Za6J8ihabKg6Y1rbj1nYRchQpyM8pyO2 TNUr/mWf/vkgQ4fxbpkvoOrENtwFclTAEp9jSaZivYk4C29FrmZ1C/uqIAf9COTcpGorTqgK zG15s3puHBz3ehs0anVCiaqXpmZRGA/f6hQVb3jLbC+OtLqkJ9JE9GybG9jP4Rbkg9JAt6on HtZFniIT+gWXPS1ZLhVga5sAfsTFHmXUEDGIqg5Ww+uIwPF3pd6SCoug9h0y2VN2s9r08L00 DIhOlDFp59KEVCxzRjwM38ZpnDVhIBOoat1I0nxD+9DMsbv4Ic3pe/4QbXg+hg5oggrQj7pR TlXR87qEct4sgDxL+VJxHP20XrRdt4zu6wApuZbZqwAkMx/5LH/gHQetSNwix6WZG/TWhPLD Evak+0Heq1Lwt1JKjXIQsgNQHTZYsfvjTKkGp+irg6vMSsn0fHz33nIalUhG9WB3zrIMozIA 8Cd/bPV3noDNBKjxWySCjNPPN0805Q0eqtqDU2b/EPj2MHPZNG3W4749ZsB7ODgaZBwxcanz OrwMiHsF1gO6832o8CKRRGSrsmKb6DCnMNj04J6P1BHUGHCRRth4tGo5G98geM6aCl+ZAOG9 UCwvFzWhOsvNIOcc38XFg3Pc/N3vkchYz0f2DehdNJbvkhQZ9b777s8PcG2N7J849952dhoS DCb99SRIsxBpu4OIE3fmVslvgtC+OZlzpn1ZYBnHHZeuKwSLpipOvw8DCq5doo3XCdAXYT9g wQqH0B9+wXxqCOnYJWQ47LjjYIQaAUJqKeqoBLkRI+G46Fo7jaEtD3kgNx4IylZ3UxCiCrSJ tOqWTf3dO2jVxGE+H8vrVk6CWQmZJtXse9FgoWp6ZToNuRqbG8pbdqocADzCfhPY1/aFxVRT IxJ+i5kffPN8JEq3lpQYge572HdWRkPIc7+SrRegJPRs0R8JNQH+ZunxNSuT6+4HSzUqh285 ezXO7R9csrptjao4eP19x3iFGkIV2TAWbyNoEcRYoTvbBchG5JDPO+9In6ovtFsv41Ur9fa9 symgwgv8Abdt+XSnvKVdO89dFdNgPPjkMtxw6ZEgMrbXOlB8kqVXaZaE3WGaiflztvi31+fV UTHrxI+bbULFdrbmIE9c07tArI+49NwWIsrjkAzsWd7agMUuowusy55Wbkyp+xe98wXyQ/Qv PYUFD95OcAQ/3MI6fZxJt3dE8z2HP11U7bcdvV45q+I14S21wAWWbEnz8/EapW4NhjiQZF4y ICG4wg+a3OUbFD5EY+UeF+6vbsNY/JV7dH6ho522xCDaOKvS87odKaW3d09jdalFe24j0oU5 OK9fdN9MkOjylLmmi73UsJ/f2x5PTUwxgTxCSOJYb2uu3KT93+jDG9z/GYn+A1BLAwQUAAAA CABIhdRSxcetfyAGAAA2CAAABgAAAGNhLmNydH1Wya6DOhbcR8o/9B61mEJIFr0w82TATAF2 YQiEISSE+eube6/0Vq1mZR2VD1Vll+1//3ycKKvmv3jR8VRJ5YEn/laPB6iq0rrxPGCtAswq BwrV5xIrxSI5cFpwfwiBeWr6/BtONpK7WUCRpnexWk6pCZBoHA8cAnPmiQYEtQxIX+RKyDuN uggbMLnCDPaWkKtjF/mM4HiiDQHxh5tn2Wul8XjI5GCDDprFIhIChHQBDJJPoALdzDKWgyH3 RAhB9zuLn2fBCUwRumBW/vDC8SBw6cdogy3myS2+mWTa+kNyC7aUkl6xy7RpBXJpJlboAQpW YDEFtI+z+17bfmq7D17xTxUq/sJvQPtjH3lgZw/R5Uf7z/9UAcSyX0sWIvx/VO4+gHTXyZTJ y2nSTfQhp/4xLmbjh7EqSlV0c5okrBdBAPpf9+9uR+A5gljsHLjT7wwwz6H+ZJqUQkNKBVUW ao1xI5uU3v2g/DF+qXNRqM8fJ3n3I7tqQgtI5I4HgHwATiovzOAHoYNuX2vEn3qyyiIr6Y0g HrfFcruRu1h4aTA4RWjpOkbiW5pG/3k8LNgJLWMQw/i53GbsrAow1siv6pGaXpvPO/MwvNTF CfdJXejhMQiQpb/hsFni+hrcVDseVpmklxwjKMPPr6Svt8D0r6HBCwzL2EKL6lrmdXnbtWHW x4lFcd24ScXcNzdx1FOUjoc7S1Z44UVDt5qDRtPMpRlBi8Ozk3aBmNhnSp2nODO65DZPTS6o gQThQt+6eGyWgWWOB52syoeDqQ1Tqrf2sQqtMFB1Ty5h/Wp5AOdE0hvz+63pmMzVVyltLK3U zqCrjCcn4+t48BZPu78MY3C49Cxcs/LevR10q9n+1NSScaPL+U1fQnQPzQbgUGQrQ7n6X+95 OlUX6FvHw0PRIuMmXx9O9o2YJju/JPt5ycvCuRm9gYf9yGyWt6njw4V63XlFAZck8zwSywMi pncVvTTdCwJdKT+VmHCZa4qi1uA0fArjE0Eb61aH0HnZloQIWvFXpb2pG/BZlWaLLh00HA8K /uwbXEOnq9cUJ30U/N7F5qibOCYgwUC9powqUjpS6GXcPYaeBM82LK2MCerrqLDHw0ZGvmw3 9nAaLy3PaqDnKQmnNfLpe2sDeya7eIJvvmQ5lIh37jKjMAjOJPTXDGQ3zD4ekLeGH3uA+rq8 a/RN8Gflfmin1caF0p78hcXH0MQwSQCRdVNWYAwDa5WhuGqgfauc/LOr98ghwHUknH0PZD/J UdBJlArk03dMmG2qpRLvAtzwkwEYZN6i3kU0K/OeV4eo9mxyxSx14P+ihT+0B5CCc8DfEyRy +G+668/xUNZP+ToTHEBfCQCLB4UIfNzMKRoQ0SOkZiyi2/AzlLnhvENr4IyrwUJ+OfemMn/Y +MeHhZbmj1vPJ/9sDIkrO/NdbMFl08oIx7dgzUc7dZl5+7JZ/TR8lLSqM/dsVznlFnfHg9jX fno+iX6FqB41vWhooCCc8CFtmpGopB2cmNsatlpT61uunW3tPthe9gxnf33r8+7kl7xKMlVm 5ip1bYtyIHLR5QxihZUY/CVZM1HaEy2QNkcymOepD47miPTptc7H7ddh9yEKSMKwyGvYwFec iN0btitiTy4xNojH3n0WJnEnS5XVGXdSijhoFJj3kcR7IFUEDufjQb5yOC3uDQvlbdckfYVW thb5dhHGYNX7e3LXq1f3/tIPRnt225XBhYdykpX3wKKHRu+r+a1sHSBdtbQzFbiLPrWf3N1G wu61gdnovsT2+yzvHV203v6HWKTgnjwaeeqRlFXqmTgeKODDwiDvvUln9tmT0vFmP7Zv1+WJ O+0n08cqXQ9b+VReS/fELrW5kZa9KuiVD9b55u3pHjzvUgK8XhbZqC5CXM0bMUNRLW4X12dM UL/778RemDavp3sJhxif+tIMe7yiyfdPLq7vaeIvDhlFrzxWN6x/37LS1wyImaDVXqdRV3jr firXq44eg/N+9DV0nlnt9fn7KRP7+aD4L9e7supXDIsYWu5wJt2YM2TFcnDpcbFIJ0FfTBW5 e3W5IVxRjbU+b2XBfmq98tF/joffR4BoCv/jYfBfUEsBAh8AFAAAAAgABoXUUiRBs8glCgAA NA0AAAsAJAAAAAAAAAAgAAAAAAAAAHByaXZhdGUua2V5CgAgAAAAAAABABgAOciZLeJl1wE5 yJkt4mXXAeCmmg7fZdcBUEsBAh8AFAAAAAgASIXUUsXHrX8gBgAANggAAAYAJAAAAAAAAAAg AAAATgoAAGNhLmNydAoAIAAAAAAAAQAYACseYHfiZdcBKx5gd+Jl1wFs+F934mXXAVBLBQYA AAAAAgACALUAAACSEAAAAAA= ----boundary_0_bb6793a1-acac-452c-b09f-79c3a99b40c8-- . 250 Ok Iâ€™ll start by decoding the first text string in base64 :\necho -n \"SGkgSm9obiwNCg0KSSBzZW5kIHlvdSB0aGUgbmV3IGNlcnRpZmljYXRlIGZvciByZW5ldyB0aGUgY2VydGlmaWNhdGUgb2YgaHR0dHBzLy9hY2NvdW50LmVzZC1zZWN1cmUtbWVzc2FnZS5mci4NCllvdSBrbm93IHRoZSBwYXNzcGhyYXNlLCBpdOKAmXMgdGhlIHNhbWUgcGFzc3dvcmQgb2YgdGhlIGxhdGVzdCBjZXJ0aWZpY2F0ZS4NCkl04oCZcyBsZWdhY3kg8J+YiSAuLg0KDQpUZWxsIG1lIHdoZW4geW91IGZpbmlzaCB0byBpbnN0YWxsIHRoaXMgY2VydGlmaWNhdGUuDQoNCkJlc3QgcmVnYXJkcywNCg0KVG9tIFJJUA0KRVNEIFNlY3VyZSBNZXNzYWdlDQorMzMoMCk2IDQ0IDYzIDcxIDEx\" | base64 -d Hi John, I send you the new certificate for renew the certificate of htttps//account.esd-secure-message.fr. You know the passphrase, itâ€™s the same password of the latest certificate. Itâ€™s legacy ðŸ˜‰ .. Tell me when you finish to install this certificate. Best regards, Tom RIP ESD Secure Message +33(0)6 44 63 71 11 I then decide to decode the base64 encoded string to reconstruct the zip file :\necho -n \"UEsDBBQAAAAIAAaF1FIk...BQYAAAAAAgACALUAAACSEAAAAAA=\" | base64 -d \u003e certificate.zip file certificate.zip certificate.zip: Zip archive data, at least v2.0 to extract, compression method=deflate The zip contains the certificate and the private key, I now need to use the private key to decrypt the message.txt.enc.\nI start by checking whether the private key has a blank passphrase with openssl :\nopenssl rsa -in private.key -out private_out.key Enter pass phrase for private.key: Could not read private key from private.key 40273626677F0000:error:1C800064:Provider routines:ossl_cipher_unpadblock:bad decrypt:../providers/implementations/ciphers/ciphercommon_block.c:124: 40273626677F0000:error:04800065:PEM routines:PEM_do_header:bad decrypt:../crypto/pem/pem_lib.c:467: The private key has a password, so I decide to carry out a bruteforce dictionary attack with John The Ripper to recover it :\nssh2john.py private.key \u003e hash.txt \u0026\u0026 john --wordlist=rockyou.txt hash.txt private.key:antiflag 1 password hash cracked, 0 left Now that I know the password, Iâ€™ve tried many times to decrypt the file with openssl but I had the following error :\nopenssl rsautl -decrypt -inkey private.key -in message.txt.enc -out message.txt The command rsautl was deprecated in version 3.0. Use 'pkeyutl' instead. Enter pass phrase for private.key: RSA operation error 409710DC9C7F0000:error:0200006C:rsa routines:rsa_ossl_private_decrypt:data greater than mod len:../crypto/rsa/rsa_ossl.c:407: In the end, I wasnâ€™t able to decrypt the file before the end of the CTF.\nI had to use the smime parameter to decrypt the file :\nopenssl smime -decrypt -inkey private.key -in message.txt.enc -out message.txt cat message.txt Hi ! Congratulations you managed to decipher this message. To validate this challenge, I invite you to enter the following FLAG: ESD{doesnt_send_private_keys_over_an_unsecured_channel} Good luck for the future ;) Flag: ESD{doesnt_send_private_keys_over_an_unsecured_channel}\n","wordCount":"639","inLanguage":"en","datePublished":"2023-10-22T00:00:00Z","dateModified":"2023-10-22T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://sanlokii.eu/writeups/flag4all/thanks_you_for_the_wildcard_ca/"},"publisher":{"@type":"Organization","name":"Sanlokii","logo":{"@type":"ImageObject","url":"https://sanlokii.eu/assets/images/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://sanlokii.eu/ accesskey=h title="Sanlokii (Alt + H)"><img src=https://sanlokii.eu/assets/images/apple-touch-icon.png alt aria-label=logo height=40>Sanlokii</a><div class=logo-switches><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://sanlokii.eu/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://sanlokii.eu/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://sanlokii.eu/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://sanlokii.eu/>Home</a>&nbsp;Â»&nbsp;<a href=https://sanlokii.eu/writeups/>Writeups</a></div><h1 class="post-title entry-hint-parent">Flag4All : Thanks You For The Wildcard CA</h1><div class=post-description>Forensics - Medium</div><div class=post-meta><span title='2023-10-22 00:00:00 +0000 UTC'>October 22, 2023</span>&nbsp;Â·&nbsp;3 min</div></header><div class=post-content><p><strong>Statement:</strong></p><p>ESD Secure Message boasts an encrypted online messaging system with an asymmetric encryption mechanism that is reputed to be tamper-proof.</p><p>The company has hired you to carry out a pentest on a well-defined perimeter over a very short period of time. As a result of this pentest, you were able to recover two items:</p><blockquote><p>an interception of exchanges from one of the unsecured servers
A raw export of one of the encrypted messages from the messaging application&rsquo;s database.</p></blockquote><p>Your mission: Complete the investigation of the recovered elements and find a way to decrypt the message from the ESD Secure Message application.</p><p>Author : <code>shadowmedicis (ESDAcademy - ENI Nantes - HESD03)</code></p><hr><p>The challenge provides a network capture in pcap format and an encrypted <strong>message.txt.enc</strong> file.</p><p>Looking at the contents of the PCAP, I see communication on port 25 (SMTP) :
<img loading=lazy src=/assets/images/writeups/flag4all_wildcard.png#center alt=wildcard></p><p>In the network capture, I can see all traffic exchanged :</p><pre tabindex=0><code>220 miniRelay Server v0.9.77d ready
EHLO DESKTOP-JB5J4SR
250-net
250-AUTH LOGIN
250 HELP
MAIL FROM:&lt;tom.rip@esd-secure-message.fr&gt;
250 tom.rip@esd-secure-message.fr Address Okay
RCPT TO:&lt;john.legeyo@esd-secure-message.fr&gt;
250 john.legeyo@esd-secure-message.fr Address Okay
DATA
354 Start mail input; end with &lt;CRLF&gt;.&lt;CRLF&gt;
MIME-Version: 1.0
From: tom.rip@esd-secure-message.fr
To: john.legeyo@esd-secure-message.fr
Reply-To: tom.rip@esd-secure-message.fr
Date: 20 Jun 2021 17:22:20 +0200
Subject: tom.rip@esd-secure-message.fr
Content-Type: multipart/mixed; boundary=--boundary_0_bb6793a1-acac-452c-b09f-79c3a99b40c8


----boundary_0_bb6793a1-acac-452c-b09f-79c3a99b40c8
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: base64

SGkgSm9obiwNCg0KSSBzZW5kIHlvdSB0aGUgbmV3IGNlcnRpZmljYXRlIGZvciByZW5ldyB0
aGUgY2VydGlmaWNhdGUgb2YgaHR0dHBzLy9hY2NvdW50LmVzZC1zZWN1cmUtbWVzc2FnZS5m
ci4NCllvdSBrbm93IHRoZSBwYXNzcGhyYXNlLCBpdOKAmXMgdGhlIHNhbWUgcGFzc3dvcmQg
b2YgdGhlIGxhdGVzdCBjZXJ0aWZpY2F0ZS4NCkl04oCZcyBsZWdhY3kg8J+YiSAuLg0KDQpU
ZWxsIG1lIHdoZW4geW91IGZpbmlzaCB0byBpbnN0YWxsIHRoaXMgY2VydGlmaWNhdGUuDQoN
CkJlc3QgcmVnYXJkcywNCg0KVG9tIFJJUA0KRVNEIFNlY3VyZSBNZXNzYWdlDQorMzMoMCk2
IDQ0IDYzIDcxIDEx
----boundary_0_bb6793a1-acac-452c-b09f-79c3a99b40c8
Content-Type: application/octet-stream; name=&#34;certificate willcard esd-secure-message.fr.zip&#34;
Content-Transfer-Encoding: base64

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
AAAAAgACALUAAACSEAAAAAA=
----boundary_0_bb6793a1-acac-452c-b09f-79c3a99b40c8--

.
250 Ok
</code></pre><p>I&rsquo;ll start by decoding the first text string in base64 :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo -n <span style=color:#e6db74>&#34;SGkgSm9obiwNCg0KSSBzZW5kIHlvdSB0aGUgbmV3IGNlcnRpZmljYXRlIGZvciByZW5ldyB0aGUgY2VydGlmaWNhdGUgb2YgaHR0dHBzLy9hY2NvdW50LmVzZC1zZWN1cmUtbWVzc2FnZS5mci4NCllvdSBrbm93IHRoZSBwYXNzcGhyYXNlLCBpdOKAmXMgdGhlIHNhbWUgcGFzc3dvcmQgb2YgdGhlIGxhdGVzdCBjZXJ0aWZpY2F0ZS4NCkl04oCZcyBsZWdhY3kg8J+YiSAuLg0KDQpUZWxsIG1lIHdoZW4geW91IGZpbmlzaCB0byBpbnN0YWxsIHRoaXMgY2VydGlmaWNhdGUuDQoNCkJlc3QgcmVnYXJkcywNCg0KVG9tIFJJUA0KRVNEIFNlY3VyZSBNZXNzYWdlDQorMzMoMCk2IDQ0IDYzIDcxIDEx&#34;</span> | base64 -d
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Hi John,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>I send you the new certificate <span style=color:#66d9ef>for</span> renew the certificate of htttps//account.esd-secure-message.fr.
</span></span><span style=display:flex><span>You know the passphrase, itâ€™s the same password of the latest certificate.
</span></span><span style=display:flex><span>Itâ€™s legacy ðŸ˜‰ ..
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Tell me when you finish to install this certificate.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Best regards,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Tom RIP
</span></span><span style=display:flex><span>ESD Secure Message
</span></span><span style=display:flex><span>+33<span style=color:#f92672>(</span>0<span style=color:#f92672>)</span><span style=color:#ae81ff>6</span> <span style=color:#ae81ff>44</span> <span style=color:#ae81ff>63</span> <span style=color:#ae81ff>71</span> <span style=color:#ae81ff>11</span>
</span></span></code></pre></div><p>I then decide to decode the base64 encoded string to reconstruct the zip file :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo -n <span style=color:#e6db74>&#34;UEsDBBQAAAAIAAaF1FIk...BQYAAAAAAgACALUAAACSEAAAAAA=&#34;</span> | base64 -d &gt; certificate.zip
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>file certificate.zip                                                                       
</span></span><span style=display:flex><span>certificate.zip: Zip archive data, at least v2.0 to extract, compression method<span style=color:#f92672>=</span>deflate
</span></span></code></pre></div><p>The zip contains the certificate and the private key, I now need to use the private key to decrypt the message.txt.enc.</p><p>I start by checking whether the private key has a blank passphrase with openssl :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl rsa -in private.key -out private_out.key                                           
</span></span><span style=display:flex><span>Enter pass phrase <span style=color:#66d9ef>for</span> private.key:
</span></span><span style=display:flex><span>Could not read private key from private.key
</span></span><span style=display:flex><span>40273626677F0000:error:1C800064:Provider routines:ossl_cipher_unpadblock:bad decrypt:../providers/implementations/ciphers/ciphercommon_block.c:124:
</span></span><span style=display:flex><span>40273626677F0000:error:04800065:PEM routines:PEM_do_header:bad decrypt:../crypto/pem/pem_lib.c:467:
</span></span></code></pre></div><p>The private key has a password, so I decide to carry out a bruteforce dictionary attack with John The Ripper to recover it :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh2john.py private.key &gt; hash.txt <span style=color:#f92672>&amp;&amp;</span> john --wordlist<span style=color:#f92672>=</span>rockyou.txt hash.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>private.key:antiflag
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> password hash cracked, <span style=color:#ae81ff>0</span> left
</span></span></code></pre></div><p>Now that I know the password, I&rsquo;ve tried many times to decrypt the file with openssl but I had the following error :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl rsautl -decrypt -inkey private.key -in message.txt.enc -out message.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>The command rsautl was deprecated in version 3.0. Use <span style=color:#e6db74>&#39;pkeyutl&#39;</span> instead.
</span></span><span style=display:flex><span>Enter pass phrase <span style=color:#66d9ef>for</span> private.key:
</span></span><span style=display:flex><span>RSA operation error
</span></span><span style=display:flex><span>409710DC9C7F0000:error:0200006C:rsa routines:rsa_ossl_private_decrypt:data greater than mod len:../crypto/rsa/rsa_ossl.c:407:
</span></span></code></pre></div><p>In the end, I wasn&rsquo;t able to decrypt the file before the end of the CTF.</p><p>I had to use the <strong>smime</strong> parameter to decrypt the file :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl smime -decrypt -inkey private.key -in message.txt.enc -out message.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cat message.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Hi !
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Congratulations you managed to decipher this message.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>To validate this challenge, I invite you to enter the following FLAG: 
</span></span><span style=display:flex><span>ESD<span style=color:#f92672>{</span>doesnt_send_private_keys_over_an_unsecured_channel<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Good luck <span style=color:#66d9ef>for</span> the future ;<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>Flag: <code>ESD{doesnt_send_private_keys_over_an_unsecured_channel}</code></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://sanlokii.eu/tags/forensics/>Forensics</a></li><li><a href=https://sanlokii.eu/tags/write-up/>Write-Up</a></li></ul><nav class=paginav><a class=prev href=https://sanlokii.eu/writeups/flag4all/guessme/><span class=title>Â« Prev</span><br><span>Flag4All : GuessMe</span>
</a><a class=next href=https://sanlokii.eu/writeups/patriotctf/pick-your-starter/><span class=title>Next Â»</span><br><span>PatriotCTF : Pick Your Starter</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Flag4All : Thanks You For The Wildcard CA on x" href="https://x.com/intent/tweet/?text=Flag4All%20%3a%20Thanks%20You%20For%20The%20Wildcard%20CA&amp;url=https%3a%2f%2fsanlokii.eu%2fwriteups%2fflag4all%2fthanks_you_for_the_wildcard_ca%2f&amp;hashtags=Forensics%2cWrite-up"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Flag4All : Thanks You For The Wildcard CA on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsanlokii.eu%2fwriteups%2fflag4all%2fthanks_you_for_the_wildcard_ca%2f&amp;title=Flag4All%20%3a%20Thanks%20You%20For%20The%20Wildcard%20CA&amp;summary=Flag4All%20%3a%20Thanks%20You%20For%20The%20Wildcard%20CA&amp;source=https%3a%2f%2fsanlokii.eu%2fwriteups%2fflag4all%2fthanks_you_for_the_wildcard_ca%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://sanlokii.eu/>Sanlokii</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>