<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>404CTF : Fuite en 1791 | Sanlokii</title>
<meta name=keywords content="Web,Write-up"><meta name=description content="Web - Medium"><meta name=author content><link rel=canonical href=https://sanlokii.eu/writeups/404ctf/fuite-en-1791/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://sanlokii.eu/assets/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://sanlokii.eu/assets/images/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://sanlokii.eu/assets/imagesfavicon-32x32.png><link rel=apple-touch-icon href=https://sanlokii.eu/assets/images/apple-touch-icon.png><link rel=mask-icon href=https://sanlokii.eu/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://sanlokii.eu/writeups/404ctf/fuite-en-1791/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="404CTF : Fuite en 1791"><meta property="og:description" content="Web - Medium"><meta property="og:type" content="article"><meta property="og:url" content="https://sanlokii.eu/writeups/404ctf/fuite-en-1791/"><meta property="og:image" content="https://sanlokii.eu/assets/images/yggdrasil_circle.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2023-06-05T00:00:00+00:00"><meta property="article:modified_time" content="2023-06-05T00:00:00+00:00"><meta property="og:site_name" content="Sanlokii's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sanlokii.eu/assets/images/yggdrasil_circle.png"><meta name=twitter:title content="404CTF : Fuite en 1791"><meta name=twitter:description content="Web - Medium"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://sanlokii.eu/writeups/"},{"@type":"ListItem","position":2,"name":"404CTF : Fuite en 1791","item":"https://sanlokii.eu/writeups/404ctf/fuite-en-1791/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"404CTF : Fuite en 1791","name":"404CTF : Fuite en 1791","description":"Web - Medium","keywords":["Web","Write-up"],"articleBody":"Statement:\nJust as the sweet smell of coffee began to fill Le Procope, a woman interrupted the calm of the cozy room. Straight out of the 18th century, Olympe de Gouge bursts in and rushes to your table.\nYou!\" she exclaimed.\nMe?\" you reply. Yes, you, take this letter urgently to Anne-Catherine Helvétius. To whom? What’s it about? I can’t explain now, but the contents of this letter could change the course of history, so don’t waste any time.\" And before you could question her further, she walked through the door and out of the coffee shop.\nIn utter bewilderment, you begin to peruse the letter…\nThe website is fairly quick to analyze, and contains the following home page : The home page contains the following redirect link : https://ddfc.challenges.404ctf.fr/ddfc?expiry=-5625891076\u0026signature=wawF6dC4Hz9g5NyCc3j1KCDcfztFE/sp\nModifying the URL parameters produces the following errors :\nExpired link Invalid signature Missing signature or expiry Analyzing the URL, I notice the following points:\nThe expiry parameter corresponds to the date below : date -d @-5625891076 Wed. Sept. 21, 1791 12:38:05 LMT The signature parameter which seems to be base64 encoded I spent many hours trying to find a method of hash collision between the expiry and signature values, but given my poor knowledge of cryptography, I changed my approach.\nSo I decided to concentrate on GET parameters and try to exploit an HTTP Parameter Pollution vulnerability.\nI add the expiry parameter a second time in the GET request to observe the behavior : https://ddfc.challenges.404ctf.fr/ddfc?expiry=-5625891076\u0026signature=wawF6dC4Hz9g5NyCc3j1KCDcfztFE/sp\u0026expiry=\nThe website responds with the Missing signature or expiry error message when it should respond with Expired Link if the parameter was not interpreted.\nIn view of the site’s response, this method seems to be fallible.\nI add now an unexpired timestamp to the second expiry value : https://ddfc.challenges.404ctf.fr/ddfc?expiry=-5625891076\u0026signature=wawF6dC4Hz9g5NyCc3j1KCDcfztFE/sp\u0026expiry=5625891076\nI can now access the Declaration of the Rights of Woman and of the Citizen.\nFlag: 404CTF{l4_p011uti0n_c_3st_m41}\n","wordCount":"312","inLanguage":"en","datePublished":"2023-06-05T00:00:00Z","dateModified":"2023-06-05T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://sanlokii.eu/writeups/404ctf/fuite-en-1791/"},"publisher":{"@type":"Organization","name":"Sanlokii","logo":{"@type":"ImageObject","url":"https://sanlokii.eu/assets/images/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://sanlokii.eu/ accesskey=h title="Sanlokii (Alt + H)"><img src=https://sanlokii.eu/assets/images/apple-touch-icon.png alt aria-label=logo height=40>Sanlokii</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://sanlokii.eu/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://sanlokii.eu/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://sanlokii.eu/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://sanlokii.eu/>Home</a>&nbsp;»&nbsp;<a href=https://sanlokii.eu/writeups/>Writeups</a></div><h1 class="post-title entry-hint-parent">404CTF : Fuite en 1791</h1><div class=post-description>Web - Medium</div><div class=post-meta><span title='2023-06-05 00:00:00 +0000 UTC'>June 5, 2023</span>&nbsp;·&nbsp;2 min</div></header><div class=post-content><p><strong>Statement:</strong></p><p>Just as the sweet smell of coffee began to fill Le Procope, a woman interrupted the calm of the cozy room. Straight out of the 18th century, Olympe de Gouge bursts in and rushes to your table.</p><p>You!" she exclaimed.</p><ul><li>Me?" you reply.</li><li>Yes, you, take this letter urgently to Anne-Catherine Helvétius.</li><li>To whom? What&rsquo;s it about?</li><li>I can&rsquo;t explain now, but the contents of this letter could change the course of history, so don&rsquo;t waste any time."</li></ul><p>And before you could question her further, she walked through the door and out of the coffee shop.</p><p>In utter bewilderment, you begin to peruse the letter&mldr;</p><hr><p>The website is fairly quick to analyze, and contains the following home page :
<img loading=lazy src=/assets/images/writeups/404_1791.png#center alt=1791></p><p>The home page contains the following redirect link :
<code>https://ddfc.challenges.404ctf.fr/ddfc?expiry=-5625891076&amp;signature=wawF6dC4Hz9g5NyCc3j1KCDcfztFE/sp</code></p><p>Modifying the URL parameters produces the following errors :</p><ul><li>Expired link</li><li>Invalid signature</li><li>Missing signature or expiry</li></ul><p>Analyzing the URL, I notice the following points:</p><ul><li>The expiry parameter corresponds to the date below :</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>date -d @-5625891076
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Wed. Sept. 21, <span style=color:#ae81ff>1791</span> 12:38:05 LMT
</span></span></code></pre></div><ul><li>The signature parameter which seems to be base64 encoded</li></ul><p>I spent many hours trying to find a method of hash collision between the expiry and signature values, but given my poor knowledge of cryptography, I changed my approach.</p><p>So I decided to concentrate on GET parameters and try to exploit an HTTP Parameter Pollution vulnerability.</p><p>I add the expiry parameter a second time in the GET request to observe the behavior :
<code>https://ddfc.challenges.404ctf.fr/ddfc?expiry=-5625891076&amp;signature=wawF6dC4Hz9g5NyCc3j1KCDcfztFE/sp&amp;expiry=</code></p><p>The website responds with the <strong>Missing signature or expiry</strong> error message when it should respond with <strong>Expired Link</strong> if the parameter was not interpreted.</p><p>In view of the site&rsquo;s response, this method seems to be fallible.</p><p>I add now an unexpired timestamp to the second expiry value :
<code>https://ddfc.challenges.404ctf.fr/ddfc?expiry=-5625891076&amp;signature=wawF6dC4Hz9g5NyCc3j1KCDcfztFE/sp&amp;expiry=5625891076</code></p><p>I can now access the Declaration of the Rights of Woman and of the Citizen.</p><p>Flag: <code>404CTF{l4_p011uti0n_c_3st_m41}</code></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://sanlokii.eu/tags/web/>Web</a></li><li><a href=https://sanlokii.eu/tags/write-up/>Write-Up</a></li></ul><nav class=paginav><a class=prev href=https://sanlokii.eu/writeups/patriotctf/pick-your-starter/><span class=title>« Prev</span><br><span>PatriotCTF : Pick Your Starter</span>
</a><a class=next href=https://sanlokii.eu/writeups/404ctf/academie-du-detail/><span class=title>Next »</span><br><span>404CTF : L'académie du détail</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share 404CTF : Fuite en 1791 on x" href="https://x.com/intent/tweet/?text=404CTF%20%3a%20Fuite%20en%201791&amp;url=https%3a%2f%2fsanlokii.eu%2fwriteups%2f404ctf%2ffuite-en-1791%2f&amp;hashtags=Web%2cWrite-up"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 404CTF : Fuite en 1791 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsanlokii.eu%2fwriteups%2f404ctf%2ffuite-en-1791%2f&amp;title=404CTF%20%3a%20Fuite%20en%201791&amp;summary=404CTF%20%3a%20Fuite%20en%201791&amp;source=https%3a%2f%2fsanlokii.eu%2fwriteups%2f404ctf%2ffuite-en-1791%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://sanlokii.eu/>Sanlokii</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>